<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><HTML 
lang="en"><HEAD><TITLE>User-Managed Access (UMA) Core Protocol</TITLE>
<META content="text/html; charset=utf-8" http-equiv="Content-Type">
<META name="description" content="User-Managed Access (UMA) Core Protocol">
<META name="GENERATOR" content="MSHTML 9.00.8112.16437">
<STYLE type="text/css"><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></STYLE>
</HEAD>
<BODY>
<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<TABLE border="0" cellSpacing="0" summary="layout" cellPadding="0" 
  width="66%"><TBODY>
  <TR>
    <TD>
      <TABLE border="0" cellSpacing="1" summary="layout" cellPadding="2" width="100%">
        <TBODY>
        <TR>
          <TD class="header">Network Working Group</TD>
          <TD class="header">T. Hardjono, Ed.</TD></TR>
        <TR>
          <TD class="header">Internet-Draft</TD>
          <TD class="header">MIT</TD></TR>
        <TR>
          <TD class="header">Intended status: Standards Track</TD>
          <TD class="header">November 30, 2011</TD></TR>
        <TR>
          <TD class="header">Expires: June 2, 2012</TD>
          <TD class="header">&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<H1><BR>User-Managed Access (UMA) Core 
Protocol<BR>draft-hardjono-oauth-umacore-02</H1>
<H3>Abstract</H3>
<P>This specification defines the User-Managed Access (UMA) core protocol. This 
protocol provides a method for users to control access to their protected 
resources, residing on any number of host sites, through an authorization 
manager that governs access decisions based on user policy.</P>
<H3>Status of this Memo</H3>
<P>This Internet-Draft is submitted  in full conformance with the provisions of 
BCP&nbsp;78 and BCP&nbsp;79.</P>
<P>Internet-Drafts are working documents of the Internet Engineering Task Force 
(IETF).  Note that other groups may also distribute working documents as 
Internet-Drafts.  The list of current Internet-Drafts is at 
http://datatracker.ietf.org/drafts/current/.</P>
<P>Internet-Drafts are draft documents valid for a maximum of six months and may 
be updated, replaced, or obsoleted by other documents at any time. It is 
inappropriate to use Internet-Drafts as reference material or to cite them other 
than as “work in progress.”</P>
<P>This Internet-Draft will expire on June 2, 2012.</P>
<H3>Copyright Notice</H3>
<P>Copyright (c) 2011 IETF Trust and the persons identified as the document 
authors.  All rights reserved.</P>
<P>This document is subject to BCP 78 and the IETF Trust's Legal Provisions 
Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on 
the date of publication of this document.  Please review these documents
 carefully, as they describe your rights and restrictions with respect to this 
document. Code Components extracted from this document must include Simplified 
BSD License text as described in Section 4.e of the Trust Legal Provisions and 
are provided without warranty as described in the Simplified BSD License.</P><A 
name="toc"></A><BR>
<HR>

<H3>Table of Contents</H3>
<P class="toc"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#introduction">1.</A>&nbsp;
 Introduction<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#anchor1">1.1.</A>&nbsp;
 Notational Conventions<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#terminology">1.2.</A>&nbsp;
 Basic Terminology<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#endpoint-discussion">1.3.</A>&nbsp;
 Endpoints, Endpoint Protection, and Tokens<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#scope-discussion">1.4.</A>&nbsp;
 Scopes, Resource Sets, Permissions, and Authorization<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">1.5.</A>&nbsp;
 AM Metadata<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#protecting-a-resource">2.</A>&nbsp;
 Protecting a Resource<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#anchor2">2.1.</A>&nbsp;
 Host Looks Up AM Metadata<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#anchor3">2.2.</A>&nbsp;
 Host Registers with AM<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#host-access-token">2.3.</A>&nbsp;
 Host Obtains Host Access Token<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#anchor4">2.4.</A>&nbsp;
 Host Registers Sets of Resources to Be Protected<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#action-desc">2.4.1.</A>&nbsp;
 Scope Descriptions<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#resource-set-desc">2.4.2.</A>&nbsp;
 Resource Set Descriptions<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#reg-api">2.4.3.</A>&nbsp;
 Resource Set Registration API<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#getting-authz-accessing-resource">3.</A>&nbsp;
 Getting Authorization and Accessing a Resource<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-h-attempt-access">3.1.</A>&nbsp;
 Requester-Host: Attempt Access at Protected Resource<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#no-token">3.1.1.</A>&nbsp;
 Requester Presents No Access Token<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#invalid-token">3.1.2.</A>&nbsp;
 Requester Presents an Invalid Access Token<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#valid-token">3.1.3.</A>&nbsp;
 Requester Presents a Valid Access Token<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-am-obtain-token">3.2.</A>&nbsp;
 Requester-AM: Requester Obtains Access Token<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-token-validation">3.3.</A>&nbsp;
 Host-AM: Ask for Requester Access Token Status<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-register-scope">3.4.</A>&nbsp;
 Host-AM: Register a Permission<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-am-authz-scope">3.5.</A>&nbsp;
 Requester-AM: Request Authorization to Add Permission<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#authz-flows">3.6.</A>&nbsp;
 Authorization Flows<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#trusted-claims-human-driven">3.6.1.</A>&nbsp;
 Authorization Flow for Requester Apps Operated by End-Users<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#errors">4.</A>&nbsp;
 Error Messages<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#oauth-error-response">4.1.</A>&nbsp;
 OAuth Error Responses<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#uma-error-response">4.2.</A>&nbsp;
 UMA Error Responses<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#anchor5">5.</A>&nbsp;
 Security Considerations<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#anchor6">6.</A>&nbsp;
 Privacy Considerations<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#conformance">7.</A>&nbsp;
 Conformance<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#IANA">8.</A>&nbsp;
 IANA Considerations<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-metadata-example">9.</A>&nbsp;
 AM Metadata Example<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#resource-reg-example">10.</A>&nbsp;
 Example of Registering Resource Sets<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#Acknowledgments">11.</A>&nbsp;
 Acknowledgments<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#anchor7">12.</A>&nbsp;
 Issues<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#rfc.references1">13.</A>&nbsp;
 References<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#rfc.references1">13.1.</A>&nbsp;
 Normative References<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#rfc.references2">13.2.</A>&nbsp;
 Informative References<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#History">Appendix&nbsp;A.</A>&nbsp;
 Document History<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#rfc.authors">§</A>&nbsp;
 Author's Address<BR></P><BR clear="all"><A name="introduction"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1"></A>
<H3>1.&nbsp; Introduction</H3>
<P>The User-Managed Access (UMA) core protocol provides a method based on <A 
class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> (currently draft 16) for users to 
control access to their protected resources, residing on any number of host 
sites, through a single authorization manager (AM) that governs access decisions 
based on user policy.</P>
<P>There are numerous use cases for UMA, where a resource owner elects to have a 
third party to control access to these resources potentially without the 
real-time presence of the resource owner. A typical example is the following: a 
web user (authorizing user) can authorize a web app (requester) to gain one-time 
or ongoing access to a resource containing his home address stored at a 
"personal data store" service (host), by telling the host to act on access 
decisions made by his authorization decision-making service (authorization 
manager or AM). The requesting party might be an e-commerce company whose site 
is acting on behalf of the user himself to assist him/her in arranging for 
shipping a purchased item, or it might be his friend who is using an online 
address book service to collect addresses, or it might be a survey company that 
uses an online service to compile population demographics. Other scenarios and 
use cases for UMA usage can be found in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMA-usecases">[UMA‑usecases]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Scenarios and Use Cases,” 
October&nbsp;2010.</SPAN><SPAN>)</SPAN></A> and <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMA-userstories">[UMA‑userstories]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA User Stories,” 
November&nbsp;2010.</SPAN><SPAN>)</SPAN></A>.</P>
<P>In enterprise settings, application access management often involves letting 
back-office applications serve only as policy enforcement points (PEPs), 
depending entirely on access decisions coming from a central policy decision 
point (PDP) to govern the access they give to requesters. This separation eases 
auditing and allows policy administration to scale in several dimensions. UMA 
makes use of a separation similar to this, letting the authorizing user serve as 
a policy administrator crafting authorization strategies on his or her own 
behalf.</P>
<P>The UMA protocol can be considered an advanced application of <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> in that it profiles, extends, and 
embeds OAuth in various ways. An AM can be thought of as an enhanced OAuth 
authorization server; a host as an enhanced resource server; and a requester as 
an enhanced client, acquiring an access token and the requisite authorization to 
access a protected resource at the host.</P>
<P>The UMA protocol has three broad phases, as shown in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMA-phases">Figure&nbsp;1</A>.
</P><BR>
<HR class="insert">
<A name="UMA-phases"></A>
<P style="text-align: center;">The Three Phases of the UMA Protocol</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>                                   +-----+----------------+
                                   | UA  |  authorizing   |
               +-------Manage (A)--|     |      user      |
               |                   +-----+----------------+
               |   Phase 1:              |       UA       |
               |   protect a             +----------------+
               |   resource                      |
               |                            Control (B)
               |                                 |
               v                                 v
        +-----------+              +-----+----------------+
        |   host    |&lt;-Protect-(C)-|prot | authorization  |
        |           |              | API |  manager (AM)  |
        +-----------+              +-----+----------------+
        | protected |                    | authorization  |
        | resource  |                    |      API       |
        +-----------+                    +----------------+
               ^                                 |
               |   Phases 2 and 3:         Authorize (D)
               |   get authz and                 |
               |   access a resource             v
               |                         +----------------+
               +-------Access (E)--------|   requester    |
                                         +----------------+
                                         (requesting party)</PRE></DIV>
<TABLE border="0" cellSpacing="2" cellPadding="0" align="center">
  <TBODY>
  <TR>
    <TD align="center"><FONT size="1" 
      face="monaco, MS Sans Serif"><B>&nbsp;Figure&nbsp;1&nbsp;</B></FONT><BR></TD></TR></TBODY></TABLE>
<HR class="insert">

<P>In broad strokes, the phases are as follows:</P>
<OL class="text">
  <LI>Protect a resource (described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#protecting-a-resource">Section&nbsp;2<SPAN> 
  (</SPAN><SPAN class="info">Protecting a Resource</SPAN><SPAN>)</SPAN></A>).
  </LI>
  <LI>Get authorization (described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#getting-authz-accessing-resource">Section&nbsp;3<SPAN> 
  (</SPAN><SPAN class="info">Getting Authorization and Accessing a 
  Resource</SPAN><SPAN>)</SPAN></A>).</LI>
  <LI>Access a resource (described along with Phase 2 in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#getting-authz-accessing-resource">Section&nbsp;3<SPAN> 
  (</SPAN><SPAN class="info">Getting Authorization and Accessing a 
  Resource</SPAN><SPAN>)</SPAN></A>).</LI></OL>
<P>In more detail, the phases work as follows: </P>
<OL class="text">
  <LI><EM>Protect a resource:</EM> The authorizing user has chosen to use a host 
  for managing online resources ("A"), and introduces this host to an AM using 
  an OAuth-mediated interaction that results in the AM giving the host an access 
  token. The host uses AM's protection API to tell the AM what sets of resources 
  to protect ("C"). Out of band of the UMA protocol, the authorizing user 
  instructs the AM what policies to attach to the registered resource sets 
  ("B"). Requesters are not yet in the picture.</LI>
  <LI><EM>Get authorization:</EM> This phase involves the requester, host, and 
  AM. It may also involve synchronous action by the authorizing user if this 
  person is the same person as the requesting party. This phase is dominated by 
  a loop of activity in which the requester approaches the host seeking access 
  to a protected resource ("E"), is sent to obtain an access token from the AM 
  if it does not have one, and then must demonstrate to the AM that it satisfies 
  the user's authorization policy governing the sought-for resource and scope of 
  access if it does not already have the required access permission ("D").</LI>
  <LI><EM>Access a resource:</EM> This phase involves the requester successfully 
  presenting an access token that has sufficient permission associated with it 
  to the host in order to gain access to the desired resource ("E"). In this 
  sense, it is the "happy path" within phase 2.</LI></OL><A 
name="anchor1"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.1"></A>
<H3>1.1.&nbsp; Notational Conventions</H3>
<P>The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT', 'SHOULD', 
'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this document are to be 
interpreted as described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#RFC2119">[RFC2119]<SPAN> 
(</SPAN><SPAN class="info">Bradner, S., “Key words for use in RFCs to Indicate 
Requirement Levels,” March&nbsp;1997.</SPAN><SPAN>)</SPAN></A>.</P>
<P>Unless otherwise noted, all the protocol properties and values are case 
sensitive.</P>
<P>The assignment in this document of URI labels is temporary, awaiting final 
standardization in the eventual standards body within which this specification 
is taken up as a work item.</P><A name="terminology"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.2"></A>
<H3>1.2.&nbsp; Basic Terminology</H3>
<P>UMA introduces the following terms, utilizing OAuth and other identity and 
access management concepts.</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>authorizing user</DT>
    <DD>An UMA-defined variant of an OAuth end-user resource owner; a web user 
    who configures an authorization manager with policies that control how it 
    assigns access permissions to requesters for a protected resource.</DD>
    <DT>authorization manager (AM)</DT>
    <DD>An UMA-defined variant of an OAuth authorization server that carries out 
    an authorizing user's policies governing access to a protected resource.
    </DD>
    <DT>protected resource</DT>
    <DD>An access-restricted resource at a host, which is being policy-protected 
    by an AM.</DD>
    <DT>host</DT>
    <DD>An UMA-defined variant of an OAuth resource server that enforces access 
    to the protected resources it hosts, as governed by an authorization 
    manager.</DD>
    <DT>claim</DT>
    <DD>A statement of the value or values of one or more identity attributes of 
    a requesting party. A requesting party may need to provide claims to an 
    authorization manager in order to satisfy policy and gain permission for 
    access to a protected resource.</DD>
    <DT>requester</DT>
    <DD>An UMA-defined variant of an OAuth client that seeks access to a 
    protected resource.</DD>
    <DT>requesting party</DT>
    <DD>A web user, or a corporation or other legal person, that uses a 
    requester to seek access to a protected resource. If the requesting party is 
    a natural person, it may or may not be the same person as the authorizing 
    user.</DD>
    <DT>resource set</DT>
    <DD>A host-managed set of one or more resources to be AM-protected. In 
    authorization policy terminology, a resource set is the "object" being 
    protected.</DD>
    <DT>scope</DT>
    <DD>A bounded extent of access that is possible to perform on a resource 
    set. In authorization policy terminology, a scope is one of the potentially 
    many "verbs" that can logically apply to a resource set. Whereas OAuth 
    scopes apply to resource sets that are implicit, UMA associates scopes with 
    explicitly labeled resource sets.</DD>
    <DT>permission</DT>
    <DD>A scope of access over a particular resource set at a particular host 
    that is being asked for by, or being granted to, a requester. In 
    authorization policy terminology, a permission is the "verb" portion of an 
    entire policy that also includes a "subject" (requesting party) and an 
    "object" (resource set).</DD></DL></BLOCKQUOTE><A 
name="endpoint-discussion"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.3"></A>
<H3>1.3.&nbsp; Endpoints, Endpoint Protection, and Tokens</H3>
<P>Various UMA entities present APIs for other UMA entities to use. These APIs 
are as follows:</P>
<UL class="text">
  <LI>The AM presents a <EM>protection API</EM> to the host, as standardized by 
  this specification. This API is OAuth-protected, requiring a host access token 
  (issued by the AM) for successful access (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#host-access-token">Section&nbsp;2.3<SPAN> 
  (</SPAN><SPAN class="info">Host Obtains Host Access 
  Token</SPAN><SPAN>)</SPAN></A> for this issuance process).</LI>
  <LI>The AM presents an <EM>authorization API</EM> to the requester, as 
  standardized by this specification. This API is OAuth-protected, requiring a 
  requester access token (issued by the AM) for successful access (see <A class="info" 
  href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-am-obtain-token">Section&nbsp;3.2<SPAN> 
  (</SPAN><SPAN class="info">Requester-AM: Requester Obtains Access 
  Token</SPAN><SPAN>)</SPAN></A> for this issuance process).</LI>
  <LI>The host presents a <EM>protected resource</EM> to the requester, which 
  can be considered -- and may in fact be -- an application-specific or 
  proprietary API. This API is UMA-protected, requiring a requester access token 
  (issued by the AM) and sufficient permissions (also issued by the AM) for 
  successful access (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-am-authz-scope">Section&nbsp;3.5<SPAN> 
  (</SPAN><SPAN class="info">Requester-AM: Request Authorization to Add 
  Permission</SPAN><SPAN>)</SPAN></A> for this latter issuance process).</LI></UL>
<P>The AM presents the following endpoints to the host as part of its protection 
API:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>host access token endpoint</DT>
    <DD>Part of standard OAuth, as profiled by UMA. The endpoint at which the 
    host asks for a host access token on the authorizing user's behalf. (The AM 
    may also choose to issue a refresh token.) It will use this token to gain 
    access to the other protection API endpoints.</DD>
    <DT>host user authorization endpoint</DT>
    <DD>Part of standard OAuth, as profiled by UMA. The endpoint to which the 
    host redirects the authorizing user to authorize the host to use this AM for 
    protecting resources, if the OAuth authorization code grant type is being 
    used.</DD>
    <DT>resource set registration endpoint</DT>
    <DD>The endpoint at which the host registers resource sets it wants the AM 
    to protect.</DD>
    <DT>permission registration endpoint</DT>
    <DD>The endpoint at which the host registers permissions that it anticipates 
    a requester will shortly be asking for from the AM.</DD>
    <DT>token status endpoint</DT>
    <DD>The endpoint at which the host submits requester access tokens that have 
    accompanied an access request, to learn what currently valid permissions are 
    associated with them.</DD></DL></BLOCKQUOTE>
<P>The AM presents the following endpoints to the requester as part of its 
authorization API:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>requester access token endpoint</DT>
    <DD>Part of standard OAuth, as profiled by UMA. The endpoint at which the 
    requester asks for a requester access token. (The AM may also choose to 
    issue a refresh token.) It will use this token to gain access to the other 
    authorization API endpoint.</DD>
    <DT>permission endpoint</DT>
    <DD>The endpoint at which the requester asks for authorization to have a new 
    permission associated with its requester access token.</DD></DL></BLOCKQUOTE>
<P>Finally, the host presents one or more protected resource endpoints to the 
requester:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>protected resource endpoint</DT>
    <DD>An endpoint at which a requester attempts to access resources. This can 
    be a singular API endpoint, one of a set of API endpoints, a URI 
    corresponding to an HTML document, or any other URI. The requester needs to 
    present a requester access token associated with sufficient permissions in 
    order to gain access.</DD></DL></BLOCKQUOTE>
<P>Similarly to OAuth authorization servers, an UMA AM has the opportunity to 
manage the validity periods of the access tokens, the corresponding refresh 
tokens, and even the client credentials that it issues. Different lifetime 
strategies may be suitable for different resources and scopes of access, and the 
AM has the opportunity to give the authorizing user control through policy.</P>
<P>Access tokens are currently assumed to be merely opaque strings (as discussed 
in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A> and <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#conformance">Section&nbsp;7<SPAN> 
(</SPAN><SPAN class="info">Conformance</SPAN><SPAN>)</SPAN></A>). Thus, when an 
AM associates a permission with a requester access token, a host cannot 
subsequently inspect such a token locally to assess whether a needed permission 
has been granted. It must instead ask the AM to provide the token's status.</P>
<A name="scope-discussion"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.4"></A>
<H3>1.4.&nbsp; Scopes, Resource Sets, Permissions, and Authorization</H3>
<P>UMA extends the OAuth concept of a "scope" by defining scopes as applying to 
particular labeled resource sets, rather than leaving the relevant resources 
(such as API endpoints or URIs) implicit. A resource set can have any number of 
scopes, which together describe the universe of actions that <EM>can be</EM> 
taken on this protected resource set. For example, a resource set representing a 
status update API might have scopes that include adding an update or reading 
updates. A resource set representing a photo album might have scopes that 
include viewing a slideshow or printing the album. Hosts register resource sets 
and their scopes when there is not yet any requesting party or requester in the 
picture.</P>
<P>Resource sets and scopes have meaning only to hosts and their users, in the 
same way that application-specific host APIs have meaning only to these 
entities. The AM is merely a conveyor of labels and descriptions for these 
constructs, to help the authorizing user set policies that guide eventual 
authorization processes.</P>
<P>In contrast to an UMA scope, an UMA permission reflects an <EM>actual</EM> 
authorization process for a requester to access a particular resource set in a 
scoped (bounded) manner. Hosts register permission requests on behalf of 
requesters that have attempted access. Requesters subsequently ask AMs for 
permissions to be associated with their tokens. AMs grant (or deny) permissions 
to requesters.</P>
<P>In order to represent meaningful, auditable, and potentially legally 
enforceable authorization (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMA-trustmodel">[UMA‑trustmodel]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Trust Model,” 
February&nbsp;2011.</SPAN><SPAN>)</SPAN></A>), a permission is bound to a 
particular set of UMA entities and parties. This includes the requesting party, 
the requester (so that the same requesting party would have to go through the 
authorization process for each client application they use), the host, the 
resource set on which access is being attempted, and therefore also the AM 
protecting it and the authorizing user who is controlling access.</P>
<P>Unlike scopes (but similarly to tokens themselves; see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#endpoint-discussion">Section&nbsp;1.3<SPAN> 
(</SPAN><SPAN class="info">Endpoints, Endpoint Protection, and 
Tokens</SPAN><SPAN>)</SPAN></A>), permissions have a validity period.</P><A 
name="am-endpoints"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.5"></A>
<H3>1.5.&nbsp; AM Metadata</H3>
<P>The AM MUST provide an XRD 1.0-formatted document at the hostmeta location 
(see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#hostmeta">hostmeta<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [hostmeta]), documenting the following: 
</P>
<UL class="text">
  <LI>Major conformance options supported by the AM (described further in <A 
  class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#conformance">Section&nbsp;7<SPAN> 
  (</SPAN><SPAN class="info">Conformance</SPAN><SPAN>)</SPAN></A>)</LI>
  <LI>Protection and authorization API endpoints (as described in <A class="info" 
  href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#endpoint-discussion">Section&nbsp;1.3<SPAN> 
  (</SPAN><SPAN class="info">Endpoints, Endpoint Protection, and 
  Tokens</SPAN><SPAN>)</SPAN></A>)</LI></UL>
<P>See <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-metadata-example">Section&nbsp;9<SPAN> 
(</SPAN><SPAN class="info">AM Metadata Example</SPAN><SPAN>)</SPAN></A> for a 
full example of AM metadata.</P>
<P>XRD property type values for conformance options:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>http://docs.kantarainitiative.org/uma/1.0/client_reg</DT>
    <DD>OPTIONAL (zero or one). Whether dynamic client registration, such as 
    through <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OCDynClientReg">[OCDynClientReg]<SPAN> 
    (</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Dynamic Client 
    Registration 1.0,” September&nbsp;2011.</SPAN><SPAN>)</SPAN></A>, is 
    supported for both hosts and requesters. The only values for this property 
    currently available are "yes" (dynamic registration is supported, using an 
    unspecified method) and "no" (it is not supported; hosts and requesters are 
    required to pre-register). The default is AM-specific. This property is not 
    currently extensible. (This conformance option is largely a placeholder for 
    now.)</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/token_types</DT>
    <DD>REQUIRED (one or more). An access token type produced by this AM. 
    Currently the only value for this property defined by this specification is 
    "artifact", meaning an opaque token string whose associations the host MUST 
    determine through a token status interaction with the AM (see <A class="info" 
    href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
    (</SPAN><SPAN class="info">Host-AM: Ask for Requester Access Token 
    Status</SPAN><SPAN>)</SPAN></A>). The AM is REQUIRED to support the artifact 
    token type, and to supply this value explicitly in the metadata. The AM MAY 
    declare its support for additional access token types by assigning each one 
    a unique absolute URI as the value of this property.</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/host_authz_grant_types</DT>
    <DD>REQUIRED (one or more). An OAuth grant type supported by this AM. The 
    value MUST be one of the grant_type values defined in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
    (</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
    September&nbsp;2011.</SPAN><SPAN>)</SPAN></A>, or alternatively an extension 
    grant type indicated by a unique absolute URI. The AM is REQUIRED to support 
    the authorization_code and client_credentials grant types, and to supply 
    these values explicitly in the metadata. The authorization_code grant type 
    is primarily intended for use with hosts, and the client_credentials grant 
    type is primarily intended for use with requesters.</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/claim_types</DT>
    <DD>OPTIONAL (zero or more). A claim format and associated sub-protocol for 
    gathering claims from requesting parties, as supported by this AM. Currently 
    the only value for this property defined by this specification is "openid", 
    for which details are supplied in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#trusted-claims">Section&nbsp;3.6.1.1<SPAN> 
    (</SPAN><SPAN class="info">Gathering Claims from Requesting End-Users with 
    OpenID Connect</SPAN><SPAN>)</SPAN></A>. The AM MAY declare its support for 
    claim types other than "openid" by assigning each one a unique absolute URI 
    as the value of this property.</DD></DL></BLOCKQUOTE>
<P>XRD link relationship rel values for protection API endpoints: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>http://docs.kantarainitiative.org/uma/1.0/host_token_uri</DT>
    <DD>REQUIRED. The host access token endpoint. Available HTTP methods are as 
    defined by <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
    (</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
    September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> for a token endpoint. Supplies 
    the endpoint the host uses to ask for a host access token.</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/host_user_uri</DT>
    <DD>REQUIRED. The host user authorization endpoint. Available HTTP methods 
    are as defined by <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
    (</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
    September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> for an end-user authorization 
    endpoint. Supplies the endpoint the host uses to gather the consent of the 
    authorizing user for a host-AM relationship if it is using the authorization 
    code grant type. The AM MUST support the authorization code grant type 
    method of obtaining the authorizing user's consent.</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/host_resource_reg_uri</DT>
    <DD>REQUIRED. The resource set registration endpoint. Requests to this 
    endpoint require a host access token to be present. Supplies the endpoint 
    the host uses for registering resource sets with the AM to be protected (see 
    <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#reg-api">Section&nbsp;2.4.3<SPAN> 
    (</SPAN><SPAN class="info">Resource Set Registration 
    API</SPAN><SPAN>)</SPAN></A>). This endpoint SHOULD require the use of a 
    transport-layer security mechanism such as TLS.</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/host_token_status_uri</DT>
    <DD>REQUIRED. The token status endpoint. Requests to this endpoint require a 
    host access token to be present. Supplies the endpoint the host uses to 
    request the status of access tokens presented to them by requesters with 
    respect to currently valid permissions. This endpoint SHOULD require the use 
    of a transport-layer security mechanism such as TLS.</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/host_perm_reg_uri</DT>
    <DD>REQUIRED. The permission registration endpoint. Requests to this 
    endpoint require a host access token to be present. Supplies the endpoint 
    the host uses for registering permissions with the AM for which a requester 
    will be seeking authorization (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-register-scope">Section&nbsp;3.4<SPAN> 
    (</SPAN><SPAN class="info">Host-AM: Register a 
    Permission</SPAN><SPAN>)</SPAN></A>). This endpoint SHOULD require the use 
    of a transport-layer security mechanism such as TLS.</DD></DL></BLOCKQUOTE>
<P>XRD link relationship rel values for authorization API endpoints: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>http://docs.kantarainitiative.org/uma/1.0/req_token_uri</DT>
    <DD>REQUIRED. The requester access token endpoint. Available HTTP methods 
    are as defined by <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
    (</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
    September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> for a token issuance endpoint. 
    Supplies the endpoint the requester uses to ask for an access token. This 
    endpoint SHOULD require the use of a transport-layer security mechanism such 
    as TLS.</DD>
    <DT>http://docs.kantarainitiative.org/uma/1.0/req_perm_uri</DT>
    <DD>REQUIRED. The permission endpoint. Supplies the endpoint the requester 
    uses to ask for authorization to have a new permission associated with its 
    existing requester access token, which MUST accompany the request. This 
    endpoint SHOULD require the use of a transport-layer security mechanism such 
    as TLS.</DD></DL></BLOCKQUOTE><A name="protecting-a-resource"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2"></A>
<H3>2.&nbsp; Protecting a Resource</H3>
<P>Phase 1 of UMA is protecting a resource. The user, host, and AM perform the 
following steps in order to successfully complete Phase 1: </P>
<OL class="text">
  <LI>The host (having learned the general location of the relevant AM out of 
  band) looks up the AM's metadata and learns about its protection API endpoints 
  and supported formats.</LI>
  <LI>If the host has not yet obtained a unique OAuth client identifier and 
  optional secret from the AM, it registers with the AM as required. It MAY do 
  this using <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OCDynClientReg">[OCDynClientReg]<SPAN> 
  (</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Dynamic Client 
  Registration 1.0,” September&nbsp;2011.</SPAN><SPAN>)</SPAN></A>, if the AM 
  supports it.</LI>
  <LI>The host obtains a host access token from the AM with the authorizing 
  user's consent.</LI>
  <LI>The host registers any resource sets with the AM that are intended to be 
  protected. (This step is repeated when and as needed.)</LI></OL>
<P>If the host undertakes these actions successfully, the results are as 
follows:</P>
<UL class="text">
  <LI>The host has received metadata about the AM, such as endpoints it needs to 
  use in interacting with the AM.</LI>
  <LI>The host has received an OAuth host access token that represents this 
  authorizing user's approval for the host to work with the AM in protecting 
  resources.</LI>
  <LI>The AM has acquired information about resource sets at this host that it 
  is supposed to protect on behalf of this authorizing user.</LI></UL><A name="anchor2"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.1"></A>
<H3>2.1.&nbsp; Host Looks Up AM Metadata</H3>
<P>The host needs to learn the AM's protection API endpoints before they can 
begin interacting. To get the host started in this process, the authorizing user 
might provide the AM's location to it, for example, by typing a URL into a web 
form field or clicking a button. Alternatively, the host might already be 
configured to work with a single AM without requiring any user input. The exact 
process is beyond the scope of this specification, and it is up to the host to 
choose a method to learn the AM's general location.</P>
<P>From the data provided, discovered, or configured, the host MUST use the 
process described in Section 2 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#hostmeta">hostmeta<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [hostmeta] to retrieve the AM hostmeta 
document. For example, if the user supplied "am.example.com" as the 
Authorization Manager's domain, the host creates the URL 
"https://am.example.com/.well-known/host-meta" and performs a GET request on it. 
The AM MUST return content that includes UMA protection API endpoints as defined 
in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A>.</P><A name="anchor3"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.2"></A>
<H3>2.2.&nbsp; Host Registers with AM</H3>
<P>If the host has not already obtained an OAuth client identifier and optional 
secret from this AM, in this step it MUST do so in order to engage in 
OAuth-based interactions with the AM. It MAY do this using <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OCDynClientReg">[OCDynClientReg]<SPAN> 
(</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Dynamic Client 
Registration 1.0,” September&nbsp;2011.</SPAN><SPAN>)</SPAN></A>, if the AM 
supports it (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A> for how the AM 
MAY indicate support).</P><A name="host-access-token"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.3"></A>
<H3>2.3.&nbsp; Host Obtains Host Access Token</H3>
<P>In this step, the host acquires a host access token from the AM. The token 
represents the approval of the authorizing user for this host to trust this AM 
for protecting resources belonging to this user.</P>
<P>The host MUST use <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">OAuth2<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [OAuth2] to obtain the host access 
token. Here the host acts in the role of an OAuth client; the authorizing user 
acts in the role of an OAuth end-user resource owner; and the AM acts in the 
role of an OAuth authorization server. Once the host has obtained an access 
token, it presents it to the AM at various protection API endpoints; in 
presenting these endpoints the AM acts in the role of a resource server.</P>
<P>The AM MAY support the use of any grant type, but MUST support the 
authorization_code grant type, and SHOULD support the SAML bearer token grant 
type <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth-SAML">[OAuth‑SAML]<SPAN> 
(</SPAN><SPAN class="info">Campbell, B., “SAML 2.0 Bearer Assertion Grant Type 
Profile for OAuth 2.0,” August&nbsp;2011.</SPAN><SPAN>)</SPAN></A> 
(urn:ietf:params:oauth:grant-type:saml2-bearer) if it anticipates working with 
hosts that are operating in environments where the use of SAML is prevalent. The 
AM MUST indicate all grant types it supports in its metadata, as defined in <A 
class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A>.</P>
<P>The host has completed this step successfully when it possesses a host access 
token it can use at the AM's protection API.</P><A name="anchor4"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4"></A>
<H3>2.4.&nbsp; Host Registers Sets of Resources to Be Protected</H3>
<P>Once the host has received a host access token, for any of the user's sets of 
resources that are to be protected by this AM, it MUST register these resource 
sets at the AM's registration endpoint.</P>
<P>Note that the host is free to offer the option to protect any subset of the 
user's resources using different AMs or other means entirely, or to protect some 
resources and not others. Additionally, the choice of protection regimes can be 
made explicitly by the user or implicitly by the host. Any such partitioning by 
the host or user is outside the scope of this specification.</P>
<P>See <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#resource-reg-example">Section&nbsp;10<SPAN> 
(</SPAN><SPAN class="info">Example of Registering Resource 
Sets</SPAN><SPAN>)</SPAN></A> for an extended example of registering resource 
sets.</P><A name="action-desc"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.1"></A>
<H3>2.4.1.&nbsp; Scope Descriptions</H3>
<P>A scope is a bounded extent of access that is possible to perform on a 
resource set. A scope description is a <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#RFC4627">JSON<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
[RFC4627] document with the following properties and a Content-Type of 
application/uma-scope+json:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>name</DT>
    <DD>REQUIRED. A human-readable string describing some scope (extent) of 
    access. This name is intended for ultimate use in the AM's user interface to 
    assist the user in setting policies for protected resource sets that have 
    this available scope.</DD>
    <DT>icon_uri</DT>
    <DD>OPTIONAL. A URI for a graphic icon representing the scope. The 
    referenced icon is intended for ultimate use in the AM's user interface to 
    assist the user in setting policies for protected resource sets that have 
    this available scope.</DD></DL></BLOCKQUOTE>
<P>For example, this description characterizes a scope that involves reading or 
viewing resources (vs. creating them or editing them in some fashion):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
  "name": "View",
  "icon_uri": "http://www.example.com/icons/reading-glasses"
}
</PRE></DIV>
<P>Scope descriptions MAY contain extension properties that are not defined in 
this specification. The names of extension properties MUST consist of a fully 
qualified URL, or begin with "x-" or "X-".</P>
<P>A host MUST list a resource set's available scopes using URI references (as 
defined in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#resource-set-desc">Section&nbsp;2.4.2<SPAN> 
(</SPAN><SPAN class="info">Resource Set Descriptions</SPAN><SPAN>)</SPAN></A>). 
The scopes available for use at any one host MUST have unique URI references so 
that the host's scope descriptions are uniquely distinguishable. A scope URI 
reference MAY include a fragment identifier. Scope descriptions MAY reside 
anywhere. The host is not required to self-host scope descriptions and may wish 
to point to standardized scope descriptions residing elsewhere. Scope 
description documents MUST be accessible to AMs through GET calls made to these 
URI references</P>
<P>See <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#scope-discussion">Section&nbsp;1.4<SPAN> 
(</SPAN><SPAN class="info">Scopes, Resource Sets, Permissions, and 
Authorization</SPAN><SPAN>)</SPAN></A> for further discussion of scope-related 
concepts, and <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#resource-reg-example">Section&nbsp;10<SPAN> 
(</SPAN><SPAN class="info">Example of Registering Resource 
Sets</SPAN><SPAN>)</SPAN></A> for a long-form example of scopes used in resource 
set registration.</P><A name="resource-set-desc"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.2"></A>
<H3>2.4.2.&nbsp; Resource Set Descriptions</H3>
<P>The host defines a resource set that needs protection by registering a 
resource set description at the AM. The host registers the description and 
manages its lifecycle at the AM's host resource set registration endpoint by 
using the resource set registration API, as defined in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#reg-api">Section&nbsp;2.4.3<SPAN> 
(</SPAN><SPAN class="info">Resource Set Registration 
API</SPAN><SPAN>)</SPAN></A>.</P>
<P>A resource set description is a <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#RFC4627">JSON<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
[RFC4627] document with the following properties and a Content-Type of 
application/uma-resource-set+json.:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>name</DT>
    <DD>REQUIRED. A human-readable string describing a set of one or more 
    resources. The AM SHOULD use the name in its user interface to assist the 
    user in setting policies for protecting this resource set.</DD>
    <DT>icon_uri</DT>
    <DD>OPTIONAL. A URI for a graphic icon representing the resource set. If 
    provided, the AM SHOULD use the referenced icon in its user interface to 
    assist the user in setting policies for protecting this resource set.</DD>
    <DT>scopes</DT>
    <DD>REQUIRED. An array providing the URI references of scope descriptions 
    that are available for this resource set. The AM SHOULD use the scope names 
    and any icons defined as part of the referenced scopes in its user interface 
    to assist the user in setting policies for protecting this resource set.
    </DD></DL></BLOCKQUOTE>
<P>For example, this description characterizes a resource set (a photo album) 
that can potentially be only viewed, or alternatively to which full access can 
be granted; the URIs point to scope descriptions as defined in <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#action-desc">Section&nbsp;2.4.1<SPAN> 
(</SPAN><SPAN class="info">Scope Descriptions</SPAN><SPAN>)</SPAN></A>:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
  "name": "Photo Album",
  "icon_uri": "http://www.example.com/icons/flower.png",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}
</PRE></DIV>
<P>Resource set descriptions MAY contain extension properties that are not 
defined in this specification. The names of extension properties MUST consist of 
a fully qualified URL or begin with "x-" or "X-".</P>
<P>When a host creates or updates a resource set description (see <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#reg-api">Section&nbsp;2.4.3<SPAN> 
(</SPAN><SPAN class="info">Resource Set Registration 
API</SPAN><SPAN>)</SPAN></A>), the AM MUST attempt to retrieve the referenced 
scope descriptions. It MAY cache such descriptions as long as indicated in the 
HTTP cache-control header for the scope description resource unless the resource 
set description is subsequently updated within the validity period. At the 
beginning of an authorizing user's login session at the AM, the AM MUST attempt 
to re-retrieve scope descriptions applying to that user whose cached versions 
have expired.</P><A name="reg-api"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.3"></A>
<H3>2.4.3.&nbsp; Resource Set Registration API</H3>
<P>The host uses the RESTful API at the AM's resource set registration endpoint 
to create, read, update, and delete resource set descriptions, along with 
listing groups of such descriptions. The host MUST use its valid host access 
token obtained previously to gain access to this endpoint.</P>
<P>(Note carefully the similar but distinct senses in which the word "resource" 
is used in this section. UMA resource set descriptions are themselves managed as 
web resources at the AM through this API.)</P>
<P>The AM MUST present an API for registering resource set descriptions at a set 
of URIs with the structure "{rsreguri}/resource_set/{rsid}", where the host 
access token provides sufficient context to distinguish between identical 
resource set identifiers assigned by different hosts.</P>
<P>The components of these URIs are defined as follows:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>{rsreguri}</DT>
    <DD>The AM's resource set registration endpoint as advertised in its 
    metadata (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
    (</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A>).</DD>
    <DT>{rsid}</DT>
    <DD>An identifier for a resource set description.</DD></DL></BLOCKQUOTE>
<P>Without a specific resource set identifier path component, the URI applies to 
the set of resource set descriptions already registered.</P>
<P>Following is a summary of the five registration operations the AM is REQUIRED 
to support. Each is defined in its own section below. All other methods are 
unsupported. This API uses ETag and If-Match to ensure the desired resource at 
the AM is targeted.</P>
<UL class="text">
  <LI>Create resource set description: PUT /resource_set/{rsid}</LI>
  <LI>Read resource set description: GET /resource_set/{rsid}</LI>
  <LI>Update resource set description: PUT /resource_set/{rsid} with If-Match
  </LI>
  <LI>Delete resource set description: DELETE /resource_set/{rsid}</LI>
  <LI>List resource set descriptions: GET /resource_set/ with If-Match</LI></UL>
<P>If the request to the resource set registration endpoint is incorrect, then 
the AM responds with an error message (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>) by 
including one of the following error codes with the response: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>unsupported_method_type</DT>
    <DD>The host request used an unsupported HTTP method. The AM MUST respond 
    with the HTTP 405 (Method Not Allowed) status code and MUST fail to act on 
    the request.</DD>
    <DT>not_found</DT>
    <DD>The resource set requested from the AM cannot be found. The AM MUST 
    respond with HTTP 404 (Not Found) status code.</DD>
    <DT>precondition_failed</DT>
    <DD>The resource set that was requested to be deleted or updated at the AM 
    did not match the If-Match value present in the request. The AM MUST respond 
    with HTTP 412 (Precondition Failed) status code and MUST fail to act on the 
    request.</DD></DL></BLOCKQUOTE><A name="create-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.3.1"></A>
<H3>2.4.3.1.&nbsp; Create Resource Set Description</H3>
<P>Adds a new resource set description using the PUT method, thereby putting it 
under the AM's protection. If the request is successful, the AM MUST respond 
with a status message that includes an ETag header and _id and _rev properties 
for managing resource set description versioning.</P>
<P>The host is free to use its own methods of identifying and describing 
resource sets. The AM MUST treat them as opaque for the purpose of authorizing 
access, other than associating them with the authorizing user represented by the 
host access token used to access the API. On successfully registering a resource 
set, the host MUST use UMA mechanisms to limit access to any resources 
corresponding to this resource set, relying on the AM to supply currently valid 
permissions for authorized access.</P>
<P>Form of a "create resource set description" HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /resource_set/{rsid} HTTP/1.1
Content-Type: application/uma-resource-set+json
...

(body contains JSON resource set description to be created)
</PRE></DIV>
<P>Form of a successful HTTP response:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/uma-status+json
ETag: (matches "_rev" property in returned object)
...

{
  "status": "created",
  "_id": (id of created resource set),
  "_rev": (ETag of created resource set)
}
</PRE></DIV>
<P>Optionally, upon successful registration by the host, the AM may return a 
redirect policy URI to the host. This policy URI allows the user to set access 
policies at the AM for the resource set that was successfully registered by the 
Host.</P>
<P>Form of a successful HTTP response:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/uma-status+json
ETag: (matches "_rev" property in returned object)
...

{
  "status": "created",
  "_id": (id of created resource set),
  "_rev": (ETag of created resource set)
  "x-policy_uri":"http://am.example.com/host/222/resource/333/policy"
}
</PRE></DIV>
<A name="read-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.3.2"></A>
<H3>2.4.3.2.&nbsp; Read Resource Set Description</H3>
<P>Reads a previously registered resource set description using the GET method. 
If the request is successful, the AM MUST respond with a status message that 
includes an ETag header and _id and _rev properties for managing resource set 
description versioning.</P>
<P>Form of a "read resource set description" HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /resource_set/{rsid} HTTP/1.1
...
</PRE></DIV>
<P>Form of a successful HTTP response:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/uma-resource-set+json
...

(body contains JSON resource set description, including _id and _rev)
</PRE></DIV>
<P>If the referenced resource does not exist, the AM MUST produce an error 
response with an error property value of "not_found", as defined in <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#reg-api">Section&nbsp;2.4.3<SPAN> 
(</SPAN><SPAN class="info">Resource Set Registration 
API</SPAN><SPAN>)</SPAN></A>.</P><A name="update-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.3.3"></A>
<H3>2.4.3.3.&nbsp; Update Resource Set Description</H3>
<P>Updates a previously registered resource set description using the PUT 
method, thereby changing the resource set's protection characteristics. If the 
request is successful, the AM MUST respond with a status message that includes 
an ETag header and _id and _rev properties for managing resource set description 
versioning.</P>
<P>Form of an "update resource set description" HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /resource_set/{rsid} HTTP/1.1
Content-Type: application/resource-set+json
If-Match: (entity tag of resource)
...

(body contains JSON resource set description to be updated)
</PRE></DIV>
<P>Form of a successful HTTP response:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 204 No Content
ETag: "2"
...
</PRE></DIV>
<P>If the entity tag does not match, the AM MUST produce an error response with 
an error property value of "precondition_failed", as defined in <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#reg-api">Section&nbsp;2.4.3<SPAN> 
(</SPAN><SPAN class="info">Resource Set Registration 
API</SPAN><SPAN>)</SPAN></A>.</P><A name="delete-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.3.4"></A>
<H3>2.4.3.4.&nbsp; Delete Resource Set Description</H3>
<P>Deletes a previously registered resource set description using the DELETE 
method, thereby removing it from the AM's protection regime.</P>
<P>Form of a "delete resource set description" HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>DELETE /resource_set/{rsid}
If-Match: (entity tag of resource)
...
</PRE></DIV>
<P>Form of a successful HTTP response:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 204 No content
...
</PRE></DIV>
<P>As defined in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#reg-api">Section&nbsp;2.4.3<SPAN> 
(</SPAN><SPAN class="info">Resource Set Registration 
API</SPAN><SPAN>)</SPAN></A>, if the referenced resource does not exist the AM 
MUST produce an error response with an error property value of "not_found", and 
if the entity tag does not match the AM MUST produce an error response with an 
error property value of "precondition_failed".</P><A 
name="list-resource-sets"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.3.5"></A>
<H3>2.4.3.5.&nbsp; List Resource Set Descriptions</H3>
<P>Lists all previously registered resource set identifiers for this user using 
the GET method. The AM MUST return the list in the form of a JSON array of 
{rsid} values.</P>
<P>The host uses this method as a first step in checking whether its 
understanding of protected resources is in full synchronization with the AM's 
understanding.</P>
<P>Form of a "list resource set descriptions" HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /resource_set HTTP/1.1
...
</PRE></DIV>
<P>HTTP response:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/json
...

(body contains JSON array of {rsid} values)
</PRE></DIV>
<A name="getting-authz-accessing-resource"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3"></A>
<H3>3.&nbsp; Getting Authorization and Accessing a Resource</H3>
<P>Phase 2 of UMA is getting authorization, and Phase 3 is accessing a resource. 
In these phases, an AM orchestrates and controls requesting parties' access to a 
user's protected resources at a host, under conditions dictated by that user.
</P>
<P>Phase 3 is merely the successful completion of a requester's access attempt 
(see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#sufficient-scope">Section&nbsp;3.1.3.2<SPAN> 
(</SPAN><SPAN class="info">Requester's Token Has Sufficient 
Permission</SPAN><SPAN>)</SPAN></A>) that initially involved several embedded 
interactions among the requester, AM, and host in Phase 2. Phase 2 always begins 
with the requester attempting access at a protected resource endpoint at the 
host. How the requester came to learn about this endpoint is out of scope for 
UMA. The authorizing user might, for example, have advertised its availability 
publicly on a blog or other website, listed it in a discovery service, or 
emailed a link to a particular intended requesting party.</P>
<P>The host responds to the requester's access request in one of several ways 
depending on the circumstances of the request, either immediately or having 
first performed one or more embedded interactions with the AM. Depending on the 
nature of the host's response to an failed access attempt, the requester itself 
engages in embedded interactions with the AM before re-attempting access.</P>
<P>The interactions are as follows. The interaction summarized in each top-level 
list item MAY be the last interaction engaged in, if the requester chooses not 
to continue pursuing the access attempt, or the host chooses not to continue 
facilitating it.</P>
<UL class="text">
  <LI>The requester attempts access at a particular protected resource at a host 
  (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-h-attempt-access">Section&nbsp;3.1<SPAN> 
  (</SPAN><SPAN class="info">Requester-Host: Attempt Access at Protected 
  Resource</SPAN><SPAN>)</SPAN></A>).
  <UL class="text">
    <LI>If the access attempt is unaccompanied by a requester access token, the 
    host responds immediately with an HTTP 401 (Unauthorized) response and 
    instructions on where to go to obtain one (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#no-token">Section&nbsp;3.1.1<SPAN> 
    (</SPAN><SPAN class="info">Requester Presents No Access 
    Token</SPAN><SPAN>)</SPAN></A>).</LI></UL></LI>
  <LI>If the access attempt was accompanied by a requester access token, the 
  host checks the token's status at the AM (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
  (</SPAN><SPAN class="info">Host-AM: Ask for Requester Access Token 
  Status</SPAN><SPAN>)</SPAN></A>).
  <UL class="text">
    <LI>If the AM reports that the requester access token is invalid (see <A 
    class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#invalid-token">Section&nbsp;3.1.2<SPAN> 
    (</SPAN><SPAN class="info">Requester Presents an Invalid Access 
    Token</SPAN><SPAN>)</SPAN></A>), the host responds to the requester with an 
    HTTP 401 (Unauthorized) response and instructions on where to go to obtain a 
    token (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#no-token">Section&nbsp;3.1.1<SPAN> 
    (</SPAN><SPAN class="info">Requester Presents No Access 
    Token</SPAN><SPAN>)</SPAN></A>).</LI></UL></LI>
  <LI>If the AM supplies a token status description for a valid requester access 
  token (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#valid-token">Section&nbsp;3.1.3<SPAN> 
  (</SPAN><SPAN class="info">Requester Presents a Valid Access 
  Token</SPAN><SPAN>)</SPAN></A>) but none of the permissions associated with 
  the token match the scope of attempted access, the host registers a suitable 
  permission on the requester's behalf at the AM (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-register-scope">Section&nbsp;3.4<SPAN> 
  (</SPAN><SPAN class="info">Host-AM: Register a 
  Permission</SPAN><SPAN>)</SPAN></A>) and then responds to the requester with 
  an HTTP 403 (Forbidden) response and instructions on where to go to request 
  authorization to associate that permission with its token (see <A class="info" 
  href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#insufficient-scope">Section&nbsp;3.1.3.1<SPAN> 
  (</SPAN><SPAN class="info">Requester's Token Has Insufficient 
  Permission</SPAN><SPAN>)</SPAN></A>).</LI>
  <LI>If the requester received instructions on where to get a token, it 
  requests a token from the appropriate AM (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-am-obtain-token">Section&nbsp;3.2<SPAN> 
  (</SPAN><SPAN class="info">Requester-AM: Requester Obtains Access 
  Token</SPAN><SPAN>)</SPAN></A>).</LI>
  <LI>If the requester received instructions on where to get authorization for 
  adding a permission, it requests the permission from the appropriate AM (see 
  <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-am-authz-scope">Section&nbsp;3.5<SPAN> 
  (</SPAN><SPAN class="info">Requester-AM: Request Authorization to Add 
  Permission</SPAN><SPAN>)</SPAN></A>).
  <UL class="text">
    <LI>If the requester asked the AM to add a permission, the AM engages in an 
    authorization flow that MAY require requesting claims from the requesting 
    party (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#authz-flows">Section&nbsp;3.6<SPAN> 
    (</SPAN><SPAN class="info">Authorization Flows</SPAN><SPAN>)</SPAN></A>).
    </LI></UL></LI>
  <LI>If the AM gave status back on a valid requester access token, and at least 
  one of the permissions associated with the token match the scope of attempted 
  access, the host responds to the requester's access attempt with an HTTP 200 
  (OK) response and a representation of the resource (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#sufficient-scope">Section&nbsp;3.1.3.2<SPAN> 
  (</SPAN><SPAN class="info">Requester's Token Has Sufficient 
  Permission</SPAN><SPAN>)</SPAN></A>).</LI></UL>
<P>The interactions are described in detail in the following sections.</P><A 
name="r-h-attempt-access"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1"></A>
<H3>3.1.&nbsp; Requester-Host: Attempt Access at Protected Resource</H3>
<P>This interaction assumes that the host has previously registered with an AM 
one or more resource sets that correspond to the resource to which access is 
being attempted, such that the host considers this resource to be UMA-protected 
by a particular AM.</P>
<P>The requester typically attempts to access the desired resource at the host 
directly (for example, when a human operator of the requester software clicks on 
a thumbnail representation of the resource). The requester is expected to 
discover, or be provisioned or configured with, knowledge of the protected 
resource and its location out of band. Further, the requester is expected to 
acquire its own knowledge about the application-specific methods made available 
by the host for operating on this protected resource (such as viewing it with a 
GET method, or transforming it with some complex API call) and the possible 
scopes of access.</P>
<P>The host responds in one of the following ways.</P><A 
name="no-token"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.1"></A>
<H3>3.1.1.&nbsp; Requester Presents No Access Token</H3>
<P>If the requester does not present any access token with the request, the host 
MUST return an HTTP 401 (Unauthorized) status code, along with providing the 
AM's URI to facilitate AM metadata discovery by the requester.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 401 Unauthorized
WWW-Authenticate: UMA realm="example",
 host_id="photoz.example.com",
 am_uri="http://am.example.com"
...
</PRE></DIV>
<A name="invalid-token"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.2"></A>
<H3>3.1.2.&nbsp; Requester Presents an Invalid Access Token</H3>
<P>If the requester presents an access token with its request, the host asks the 
AM to give it the requester access token's status (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
(</SPAN><SPAN class="info">Host-AM: Ask for Requester Access Token 
Status</SPAN><SPAN>)</SPAN></A>). If the AM reports that the token is invalid, 
the host MUST return an HTTP 401 (Unauthorized) status code, along with 
providing the AM's URI to facilitate AM metadata discovery by the requester.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 401 Unauthorized
WWW-Authenticate: UMA realm="example",
  host_id="photoz.example.com",
  am_uri="http://am.example.com"
...
</PRE></DIV>
<A name="valid-token"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.3"></A>
<H3>3.1.3.&nbsp; Requester Presents a Valid Access Token</H3>
<P>If the requester presents an access token with its request, the host SHOULD 
ask the AM to give it the requester access token's status (see <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
(</SPAN><SPAN class="info">Host-AM: Ask for Requester Access Token 
Status</SPAN><SPAN>)</SPAN></A>). If the AM supplies a token status description 
for a valid requester access token, the host examines the token status 
description.</P><A name="insufficient-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.3.1"></A>
<H3>3.1.3.1.&nbsp; Requester's Token Has Insufficient Permission</H3>
<P>If the token status is not associated with any currently valid permission 
that applies to the scope of access attempted by the requester, the Host SHOULD 
register the desired permission with the AM (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#h-am-register-scope">Section&nbsp;3.4<SPAN> 
(</SPAN><SPAN class="info">Host-AM: Register a 
Permission</SPAN><SPAN>)</SPAN></A>) and then respond to the requester with the 
HTTP 403 (Forbidden) status code indicating that the token has 
"insufficient_scope" (see Section 2.4.1 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth-bearer">[OAuth‑bearer]<SPAN> 
(</SPAN><SPAN class="info">Jones, M., “The OAuth 2.0 Protocol: Bearer Tokens,” 
June&nbsp;2011.</SPAN><SPAN>)</SPAN></A>), along with providing the AM's URI to 
facilitate AM metadata discovery by the requester, and the permission ticket it 
just received from the AM iin the body of the response in JSON form.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 403 Forbidden
WWW-Authenticate: UMA realm="example",
  host_id="photoz.example.com",
  am_uri="http://am.example.com"

{
"ticket": "016f84e8-f9b9-11e0-bd6f-0021cc6004de"
}
</PRE></DIV>
<A name="sufficient-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.3.2"></A>
<H3>3.1.3.2.&nbsp; Requester's Token Has Sufficient Permission</H3>
<P>If the token status is associated with at least one currently valid 
permission that applies to the scope of access attempted by the requester, the 
host MUST give access to the desired resource.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: image/jpeg
...

/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja
3kAAQAEAAAAPAAA/+4ADkFkb2JlAGTAAAAAAf
/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAo
KCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwb
</PRE></DIV>
<P>This response constitutes the conclusion of Phase 3 of UMA.</P>
<P>The host MUST NOT give access where its request for token status did not 
reveal at least one currently active permission for that scope of access.</P><A 
name="r-am-obtain-token"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.2"></A>
<H3>3.2.&nbsp; Requester-AM: Requester Obtains Access Token</H3>
<P>When a requester does not possess a valid access token for accessing 
resources of a particular user at a particular host, it requests one from the 
AM's requester token endpoint.</P>
<P>The requester learns about this endpoint by retrieving the AM's hostmeta 
document (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A>) based on the 
"am_uri" information that was provided by the host in its previous response, as 
described in Section 2 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#hostmeta">hostmeta<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [hostmeta]. For example, if the "am_uri" 
is "am.example.com", the requester creates the URI 
"https://am.example.com/.well-known/host-meta" and performs a GET request on it.
</P>
<P>Each such token represents the set of permissions for that requesting party 
to access potentially many different resource sets (all controlled by a single 
authorizing user), with a variety of scopes, at that same host, on behalf of the 
same requesting party.</P>
<P>The requester SHOULD use the OAuth 2.0 client_credentials authorization grant 
type (see Section 4.4 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
September&nbsp;2011.</SPAN><SPAN>)</SPAN></A>).</P>
<P>If the requester does not yet have a client identifier and optional client 
secret prior to requesting an access token, it MAY request these using <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OCDynClientReg">[OCDynClientReg]<SPAN> 
(</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Dynamic Client 
Registration 1.0,” September&nbsp;2011.</SPAN><SPAN>)</SPAN></A>, if the AM 
supports it (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A> for how the AM 
MAY indicate support).</P>
<P>(Note that in UMA, unlike in plain OAuth, obtaining an access token does not 
automatically convey permission for access to any protected resource. The token 
must first be associated with at least one suitable permission for scoped access 
in order for the requester to succeed in accessing the resource.)</P><A name="h-am-token-validation"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.3"></A>
<H3>3.3.&nbsp; Host-AM: Ask for Requester Access Token Status</H3>
<P>On receiving a requester access token in an access attempt, the host asks the 
AM for that token's status. If it has a cached token status description 
available that has not expired yet, it MAY use it instead.</P>
<P>The host makes the request to the AM with a POST request to the AM's token 
status endpoint. The body of the HTTP request message contains a JSON <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#RFC4627">[RFC4627]<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
document providing the requester access token and the IP address of the 
requester's request. The host MAY, at its discretion, instead supply the 
originating IP address indicated in the requester's X-Forwarded-For: header 
value. The IP address or originating IP address is advisory only; the AM MAY 
ignore it for purposes of its own token validation process.</P>
<P>The host gains access to the token status endpoint by presenting its own host 
access token in the request.</P>
<P>Example of a request to the token validation endpoint that provides the host 
access token in the header:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>POST /token_status HTTP/1.1
Host: am.example.com
Authorization: Bearer vF9dft4qmT
Content-Type: application/json
...

{
  "token": "sbjsbhs(/SSJHBSUSSJHVhjsgvhsgvshgsv",
  "resource_set_id": "112210f47de98100",
  "host_id": "photoz.example.com",
  "ipaddr": "192.168.1.1"
}
</PRE></DIV>
<P>The AM returns the token's status in an HTTP response using the 200 OK status 
code, containing a JSON <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#RFC4627">[RFC4627]<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
document supplying the token status description. The token status description 
either contains all of the permissions that are currently valid for this 
requester access token (and thus for the requesting party on whose behalf it is 
acting), or indicates that the token is invalid. The AM MAY set a cache period 
for the returned token status description that allows the host to reuse it over 
some period of time when it later sees the same requester access token.</P>
<P>The token status description for a valid access token is a JSON array of zero 
or more permission objects, each with the following properties:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>resource_set_id</DT>
    <DD>REQUIRED. A string that uniquely identifies the resource set, access to 
    which has been granted to this requester on behalf of this requesting party. 
    The identifier MUST correspond to a resource set that was previously 
    registered as protected.</DD>
    <DT>scopes</DT>
    <DD>REQUIRED. An array referencing one or more URIs of scopes to which 
    access was granted for this resource set. Each scope MUST correspond to a 
    scope that was registered by this host for the referenced resource set.</DD>
    <DT>exp</DT>
    <DD>REQUIRED. An integer representing the expiration time on or after which 
    the permission MUST NOT be accepted for authorized access. The processing of 
    the exp property requires that the current date/time MUST be before the 
    expiration date/time listed in the exp claim. Host implementers MAY provide 
    for some small leeway, usually no more than a few minutes, to account for 
    clock skew.</DD></DL></BLOCKQUOTE>
<P>Example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/uma-token-status+json
Cache-Control: no-store
...

[
  {
    "resource_set_id": "112210f47de98100",
    "scopes": [
      "http://photoz.example.com/dev/actions/view",
      "http://photoz.example.com/dev/actions/all"
    ],
    "exp": 1300819380
  }
]
</PRE></DIV>
<P>The token status description for an invalid access token is a JSON structure, 
as follows.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/uma-token-status+json
...

{
  "token_status": "invalid"
}
</PRE></DIV>
<A name="h-am-register-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.4"></A>
<H3>3.4.&nbsp; Host-AM: Register a Permission</H3>
<P>If the permissions returned by the AM from a token status request are 
insufficient to allow this requester's access attempt, the host registers a 
permission with the AM that it believes would be sufficient for the type of 
access sought. As a result of the host registering a permission to the AM, the 
AM returns a permission ticket for the host to give to the requester in its 
response (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#insufficient-scope">Section&nbsp;3.1.3.1<SPAN> 
(</SPAN><SPAN class="info">Requester's Token Has Insufficient 
Permission</SPAN><SPAN>)</SPAN></A>).</P>
<P>The permission ticket is a short-lived opaque structure whose form is 
determined by the AM. The ticket value MUST be securely random (for example, not 
merely part of a predictable sequential series), to avoid denial-of-service 
attacks.</P>
<P>Later, when the requester asks the AM to add permissions to the requester's 
token (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#r-am-authz-scope">Section&nbsp;3.5<SPAN> 
(</SPAN><SPAN class="info">Requester-AM: Request Authorization to Add 
Permission</SPAN><SPAN>)</SPAN></A> it will submit this ticket to the AM. It is 
therefore the task of the AM to perform binding of this ticket to the requester 
and its token.</P>
<P>The host registers the permission using the POST method at the AM's 
permission registration endpoint, providing its host access token to get 
authorized access to this endpoint. The body of the HTTP request message 
contains a JSON <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#RFC4627">[RFC4627]<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
document providing the requester's access token and the requested permission.
</P>
<P>The requested scope is an object with the name "requested_permission" and the 
following properties:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>resource_set_id</DT>
    <DD>REQUIRED. A string that uniquely identifies a resource set, access to 
    which this requester is seeking access. The identifier MUST correspond to a 
    resource set that was previously registered as protected.</DD>
    <DT>scopes</DT>
    <DD>REQUIRED. An array referencing one or more identifiers of scopes to 
    which access is needed for this resource set. Each scope identifier MUST 
    correspond to a scope that was registered by this host for the referenced 
    resource set.</DD></DL></BLOCKQUOTE>
<P>Example of an HTTP request that registers a permission at the AM's permission 
registration endpoint:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>POST /host/scope_reg_uri/photoz.example.com HTTP/1.1
Content-Type: application/uma-requested-permission+json
Host: am.example.com

{
  "resource_set_id": "112210f47de98100",
  "scopes": [
      "http://photoz.example.com/dev/actions/view",
      "http://photoz.example.com/dev/actions/all"
  ]
}
</PRE></DIV>
<P>If the registration request is successful, the AM responds with an HTTP 201 
(Created) status code and includes the Location header in its response as well 
as the "ticket" property in the JSON-formatted body.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/uma-permission-ticket+json
Location: https://am.example.com/permreg/host/photoz.example.com/5454345rdsaa4543
...

{
"ticket": "016f84e8-f9b9-11e0-bd6f-0021cc6004de"
}
</PRE></DIV>
<P>If the registration request fails, the AM responds with an HTTP 400 (Bad 
Request) status code and includes one of the following error codes (see <A 
class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>):</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>invalid_resource_set_id</DT>
    <DD>The provided resource set identifier was not found at the AM.</DD>
    <DT>invalid_scope</DT>
    <DD>At least one of the scopes included in the request was not registered 
    previously by this host.</DD>
    <DT>invalid_requester_token</DT>
    <DD>The requester access token was not recognized by the AM.</DD>
    <DT>expired_requester_token</DT>
    <DD>The requester access token has expired.</DD></DL></BLOCKQUOTE><A name="r-am-authz-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.5"></A>
<H3>3.5.&nbsp; Requester-AM: Request Authorization to Add Permission</H3>
<P>In this interaction, the requester asks the AM to grant it permission for 
access. It does this at the AM's permission endpoint by supplying the permission 
ticket it got from the host, along with its requester access token and other 
pertinent information. The AM uses the ticket to look up the previously 
registered permission, maps the requested permission to operative user policies, 
undergoes any authorization flows required (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#authz-flows">Section&nbsp;3.6<SPAN> 
(</SPAN><SPAN class="info">Authorization Flows</SPAN><SPAN>)</SPAN></A>), and 
ultimately responds to the request positively or negatively.</P>
<P>The requester learns about this endpoint by retrieving the AM's hostmeta 
document (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A>) based on the 
"am_uri" information that was provided by the host in its previous response, as 
described in Section 2 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#hostmeta">hostmeta<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [hostmeta]. For example, if the "am_uri" 
is "am.example.com", the requester creates the URI 
"https://am.example.com/.well-known/host-meta" and performs a GET request on it.
</P>
<P>The requester performs a GET or POST on the permission endpoint, supplying: 
</P>
<UL class="text">
  <LI>The permission ticket it received from the host</LI>
  <LI>Its own requester access token</LI>
  <LI>A state property (to help avoid replay attacks)</LI>
  <LI>A redirect URL</LI>
  <LI>A callback URL</LI></UL>
<P>The AM MUST support GET requests to this endpoint and MAY support POST 
requests; if it supports POST, the endpoint MUST use SSL/TLS. (Requesters will 
tend to prefer POST when they want to sign the request message and preserve 
certain URL information; however, GET typically provides a smoother user 
experience.)</P>
<P>If the AM determines that the requesting party meets the authorization 
criteria set out by the authorizing user's policy (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#authz-flows">Section&nbsp;3.6<SPAN> 
(</SPAN><SPAN class="info">Authorization Flows</SPAN><SPAN>)</SPAN></A>), it 
responds with an HTTP 201 (Created) status code and provides an updated token:
</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/uma-access-token+json

{
  "token": "sbjsbhs(/SSJHBSUSSJHVhjsgvhsgvshgsv"
}
</PRE></DIV>
<P>If the content-type of the request is not recognized by the AM, the AM MUST 
produce an HTTP error.</P>
<P>If the request fails due to missing or invalid parameters, or is otherwise 
malformed, the AM SHOULD inform the requester of the error by sending an HTTP 
error response.</P>
<P>If the request fails due to an invalid, missing, or expired requester access 
token or requires higher privileges at this endpoint than provided by the access 
token, the AM responds with an OAuth error (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#oauth-error-response">Section&nbsp;4.1<SPAN> 
(</SPAN><SPAN class="info">OAuth Error Responses</SPAN><SPAN>)</SPAN></A>).</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example",
  error="invalid_token",
  error_description="The access token expired"
</PRE></DIV>
<P>If the AM ultimately does not add the requested permission, it responds using 
the appropriate HTTP status code (typically 400 or 403), and includes one of the 
following error codes in the response: (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>): </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>invalid_requester_ticket</DT>
    <DD>The provided ticket was not found at the AM. The AM SHOULD respond with 
    the HTTP 400 (Bad Request) status code.</DD>
    <DT>expired_requester_ticket</DT>
    <DD>The provided ticket has expired. The AM SHOULD respond with the HTTP 400 
    (Bad Request) status code.</DD>
    <DT>not_authorized_permission</DT>
    <DD>The requester is definitively not authorized for this permission 
    according to user policy. The AM SHOULD respond with the HTTP 403 
    (Forbidden) status code.</DD></DL></BLOCKQUOTE>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 400 Bad Request
Content-Type: application/uma-status+json
Cache-Control: no-store
...

{
  "status": "error",
  "error": "expired_requester_ticket"
}
</PRE></DIV>
<A name="authz-flows"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.6"></A>
<H3>3.6.&nbsp; Authorization Flows</H3>
<P>The AM MUST base its decisions to add permissions to requester access tokens 
on user policies. The nature of these policies is outside the scope of UMA, but 
generally speaking, they can be thought of as either independent of 
requesting-party features (for example, time of day) or dependent on 
requesting-party features (for example, whether they are over 18). This latter 
case requires the requesting party to transmit identity claims to the AM in some 
fashion.</P>
<P>The process for requesting and providing claims is extensible and may have a 
variety of dependencies on the type of requesting party (for example, natural 
person or legal person) and the type of requester application (for example, 
browser, native app, or autonomously running web service). UMA currently 
provides a framework for handling human-driven requester apps and an optional 
solution for gathering standardized claims from that end-user, and allows for 
extensions to support other solutions for this use case and other use cases. The 
AM SHOULD document its claims-handling ability in its XRD metadata through the 
claim_types property (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A>). For the 
business-level and legal implications of different technical authorization 
flows, see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMA-trustmodel">[UMA‑trustmodel]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Trust Model,” 
February&nbsp;2011.</SPAN><SPAN>)</SPAN></A>.</P><A name="trusted-claims-human-driven"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.6.1"></A>
<H3>3.6.1.&nbsp; Authorization Flow for Requester Apps Operated by 
End-Users</H3>
<P>A requester app, whether browser-based or native, is operated by a natural 
person (human end-user) in one of two typical situations:</P>
<UL class="text">
  <LI>The requesting party is a natural person (for example, a friend of the 
  authorizing user); the requesting party may even be the authorizing user 
  herself.</LI>
  <LI>The requesting party is a legal person such as a corporation, and the 
  human being operating the requester app is acting as an agent of that legal 
  person (for example, a customer support specialist representing a credit card 
  company).</LI></UL>
<P>The AM has a variety of options at this point for satisfying the authorizing 
user's policy; this specification does not dictate a single answer. For example, 
the AM could require the end-user operating the requester app to register for 
and/or log in to a local AM account, or to fill in a questionnaire, or to 
complete a purchase. It could even require several of these operations, where 
the order is significant.</P>
<P>An end-user-driven requester app MUST redirect the end-user to the AM to 
complete the process of authorization. If the AM succeeds in adding the 
requested permission, it MUST redirect the end-user requesting party back to the 
requester app when reporting success.</P><A name="trusted-claims"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.6.1.1"></A>
<H3>3.6.1.1.&nbsp; Gathering Claims from Requesting End-Users with OpenID 
Connect</H3>
<P>An AM MAY use OpenID Connect as one means of gathering claims from an 
end-user requesting party, leveraging OpenID Connect mechanisms to transmit 
claims from distributed sources. If it supports this option, the AM MUST supply 
the "openid" value for one of its claim_types properties in its AM metadata (see 
<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A> for how to 
formulate this metadata).</P>
<P>To conform to this option, the AM MUST do the following:</P>
<UL class="text">
  <LI>Serve as a conforming OpenID Relying Party and Claims Client according to 
  <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OCStandard">[OCStandard]<SPAN> 
  (</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Standard 1.0,” 
  September&nbsp;2011.</SPAN><SPAN>)</SPAN></A></LI>
  <LI>Be able to utilize at least all of the reserved claims defined in <A 
  class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OCMessages">[OCMessages]<SPAN> 
  (</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Messages 1.0,” 
  September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> in assessing policy and granting 
  permissions</LI></UL>
<P>The AM can then use any conforming OpenID Connect mechanisms and typical user 
interfaces for engaging with the UserInfo endpoints of OpenID Providers and 
Claims Providers, potentially allowing for the delivery of "trusted claims" 
(such as a verified email address or a date or birth) on which authorization 
policy may depend.</P><A name="errors"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.4"></A>
<H3>4.&nbsp; Error Messages</H3>
<P>Ultimately the host is responsible for either granting the access the 
requester attempted, or returning an error response to the requester with a 
reason for the failure. <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> defines several error responses 
for a resource server to return. UMA makes use of these error responses, but 
requires the host to "outsource" the determination of some error conditions to 
the AM. UMA defines its own additional error responses that the AM may give to 
the host and requester as they interact with it, and that the host may give to 
the requester.</P><A name="oauth-error-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.4.1"></A>
<H3>4.1.&nbsp; OAuth Error Responses</H3>
<P>When a client (host or requester) attempts to access one of the AM endpoints 
<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A> or a client 
(requester) attempts to access a protected resource at the host, it has to make 
an authenticated request by including an OAuth access token in the HTTP request 
as described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> Section 7.</P>
<P>If the client's request failed authentication, the AM or the host responds 
with an OAuth error message as described throughout <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#protecting-a-resource">Section&nbsp;2<SPAN> 
(</SPAN><SPAN class="info">Protecting a Resource</SPAN><SPAN>)</SPAN></A> and <A 
class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#getting-authz-accessing-resource">Section&nbsp;3<SPAN> 
(</SPAN><SPAN class="info">Getting Authorization and Accessing a 
Resource</SPAN><SPAN>)</SPAN></A>.</P><A name="uma-error-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.4.2"></A>
<H3>4.2.&nbsp; UMA Error Responses</H3>
<P>When a client (host or requester) attempts to access one of the AM endpoints 
<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A> or a client 
(requester) attempts to access a protected resource at the host, if the client 
request is successfully authenticated by OAuth means, but is invalid for another 
reason, the AM or host responds with an UMA error response by adding the 
following properties to the entity body of the HTTP response using the 
"application/json" media type: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>error</DT>
    <DD>REQUIRED. A single error code. Value for this property is defined in the 
    specific AM endpoint description.</DD>
    <DT>error_description</DT>
    <DD>OPTIONAL. A human-readable text providing additional information, used 
    to assist in the understanding and resolution of the error occurred.</DD>
    <DT>error_uri</DT>
    <DD>OPTIONAL. A URI identifying a human-readable web page with information 
    about the error, used to provide the end-user with additional information 
    about the error.</DD></DL></BLOCKQUOTE>
<P>Common error codes: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>invalid_request</DT>
    <DD>The request is missing a required parameter or is otherwise malformed. 
    The AM MUST respond with the HTTP 400 (Bad Request) status code.</DD>
</DL></BLOCKQUOTE>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 400 Bad Request
Content-Type: application/uma-status+json
Cache-Control: no-store
...

{
  "status": "error",
  "error": "invalid_request",
  "error_description": "There is already a resource with this identifier.",
  "error_uri": "http://am.example.com/errors/resource_exists"
}
</PRE></DIV>
<A name="anchor5"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.5"></A>
<H3>5.&nbsp; Security Considerations</H3>
<P>This specification relies mainly on OAuth security mechanisms for protecting 
the host registration endpoint at the AM so that only a properly authorized host 
can access it on behalf of the intended user. For example, the host needs to use 
a valid host access token issued through a user authorization process at the 
endpoint, and the interaction SHOULD take place over TLS. It is expected that 
the host will protect its client secret (if it was issued one) and its host 
access token, particularly if used in "bearer token" fashion.</P>
<P>In addition, this specification dictates a binding between the host access 
token and the host-specific registration area on the AM to prevent a host from 
interacting with a registration area not its own.</P>
<P>For information about the technical, operational, and legal elements of trust 
establishment between UMA entities and parties, which affects security 
considerations, see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMA-trustmodel">[UMA‑trustmodel]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Trust Model,” 
February&nbsp;2011.</SPAN><SPAN>)</SPAN></A>.</P><A name="anchor6"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.6"></A>
<H3>6.&nbsp; Privacy Considerations</H3>
<P>The AM comes to be in possession of resource set information (such as names 
and icons) that may reveal information about the user, which the AM's trust 
relationship with the host is assumed to accommodate. However, the requester is 
a less-trusted party (in fact, entirely untrustworthy until it acquires 
permissions for a requester access token in UMA protocol step 2). This 
specification recommends obscuring resource set identifiers in order to avoid 
leaking personally identifiable information to requesters through the "scope" 
mechanism.</P>
<P>For information about the technical, operational, and legal elements of trust 
establishment between UMA entities and parties, which affects privacy 
considerations, see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMA-trustmodel">[UMA‑trustmodel]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Trust Model,” 
February&nbsp;2011.</SPAN><SPAN>)</SPAN></A>.</P><A name="conformance"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.7"></A>
<H3>7.&nbsp; Conformance</H3>
<P>This section outlines conformance requirements for various entities 
implementing UMA endpoints.</P>
<P>This specification has dependencies on other specifications, as follows:</P>
<UL class="text">
  <LI>OAuth 2.0: AMs, hosts, and requesters MUST support <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OAuth2">[OAuth2]<SPAN> 
  (</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
  September&nbsp;2011.</SPAN><SPAN>)</SPAN></A> features named in this 
  specification for conformance. For example, AMs MUST support the 
  authorization_code and client_credentials grant types.</LI>
  <LI>hostmeta: AMs, hosts, and requesters MUST support the <A class="info" 
  href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#hostmeta">[hostmeta]<SPAN> 
  (</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
  May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> features named in this specification.
  </LI>
  <LI>OpenID Connect: AMs MAY support <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#OCDynClientReg">[OCDynClientReg]<SPAN> 
  (</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Dynamic Client 
  Registration 1.0,” September&nbsp;2011.</SPAN><SPAN>)</SPAN></A>, and MAY 
  choose to conform to the "openid" claim format option corresponding to the 
  OpenID Connect RP role and support for OpenID Connect reserved claims.</LI></UL>
<P>The AM's XRD metadata provides a machine-readable method for an AM to 
indicate certain of the conformance options it has chosen. Several of the 
metadata fields allow for extensibility. Where this specification does not 
already require optional features to be documented, it is RECOMMENDED that AM 
developers and deployers document any profiled or extended features explicitly 
and use XRD metadata to indicate their usage. See <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#am-endpoints">Section&nbsp;1.5<SPAN> 
(</SPAN><SPAN class="info">AM Metadata</SPAN><SPAN>)</SPAN></A> for information 
about providing and extending AM metadata.</P><A name="IANA"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.8"></A>
<H3>8.&nbsp; IANA Considerations</H3>
<P>Several UMA-specific JSON-based media types are being proposed, as follows: 
(TBS)</P><A name="am-metadata-example"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.9"></A>
<H3>9.&nbsp; AM Metadata Example</H3>
<P>Following is a conforming XRD metadata document for an AM (line breaks and 
spaces are provided for readability only):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>&lt;!-- AM conformance options --&gt;

&lt;Property type="http://docs.kantarainitiative.org/uma/1.0/client_reg"&gt;
  yes
&lt;/Property&gt;
&lt;Property type="http://docs.kantarainitiative.org/uma/1.0/token_types"&gt;
  artifact
&lt;/Property&gt;
&lt;Property type="http://docs.kantarainitiative.org/uma/1.0/host_authz_grant_types"&gt;
  authorization_code
&lt;/Property&gt;
&lt;Property type="http://docs.kantarainitiative.org/uma/1.0/host_authz_grant_types"&gt;
  client_credentials
&lt;/Property&gt;
&lt;Property type="http://docs.kantarainitiative.org/uma/1.0/claim_types"&gt;
  openid
&lt;/Property&gt;

&lt;!-- Host protection API --&gt;

&lt;Link
  rel="http://docs.kantarainitiative.org/uma/1.0/host_token_uri"
  href="https://am.example.com/host/token_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://docs.kantarainitiative.org/uma/1.0/host_user_uri"
  href="https://am.example.com/host/user_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://docs.kantarainitiative.org/uma/1.0/host_resource_reg_uri"
  href="https://am.example.com/host/resource_details_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://docs.kantarainitiative.org/uma/1.0/host_token_status_uri"
  href="https://am.example.com/host/token_validation_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://docs.kantarainitiative.org/uma/1.0/host_perm_reg_uri"
  href="https://am.example.com/host/scope_reg_uri"&gt;
&lt;/Link&gt;

&lt;!-- Requester authorization API --&gt;

&lt;Link
  rel="http://docs.kantarainitiative.org/uma/1.0/req_token_uri"
  href="https://am.example.com/requester/token_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://docs.kantarainitiative.org/uma/1.0/req_perm_uri"
  href="https://am.example.com/requester/perm_uri"&gt;
&lt;/Link&gt;</PRE></DIV>
<A name="resource-reg-example"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.10"></A>
<H3>10.&nbsp; Example of Registering Resource Sets</H3>
<P>The following example illustrates the intent and usage of resource set 
descriptions and scope descriptions as part of resource set registration.</P>
<P>This example contains some steps that are exclusively in the realm of user 
experience rather than web protocol, to achieve realistic illustration. These 
steps are labeled "User experience only". Some other steps are exclusively 
internal to the operation of the entity being discussed. These are labeled 
"Internal only".</P>
<P>An authorizing user, Alice Adams, has just uploaded a photo of her new puppy 
to a host, Photoz.example.com, and wants to ensure that this specific photo is 
not publicly accessible.</P>
<P>Alice has already introduced this host to her AM, CopMonkey.example.com, and 
thus Photoz has already obtained a host access token from CopMonkey. However, 
Alice has not previously instructed Photoz to use CopMonkey to protect any other 
photos of hers.</P>
<P>Alice has previously visited CopMonkey to map a default "do not share with 
anyone" policy to any resource sets registered by Photoz, until such time as she 
maps some other more permissive policies to those resources. (User experience 
only. This may have been done at the time Alice introduced the host to the AM, 
and/or it could have been a global or host-specific preference setting. A 
different constraint or no constraint at all might be associated with newly 
protected resources.) Other kinds of policies she may eventually map to 
particular photos or albums might be "Share only with husband@email.example.net" 
or "Share only with people in my 'family' group".</P>
<P>Photoz itself has a publicly documented application-specific API that offers 
two dozen different methods that apply to single photos, such as "addTags" and 
"getSizes", but rolls them up into two photo-related scopes of access: "view" 
(consisting of various read-only operations) and "all" (consisting of various 
reading, editing, and printing operations). It defines two scope descriptions 
that represent these scopes, which it is able to reuse for all of its users (not 
just Alice), and ensures that these scope description documents are available 
through HTTP GET requests that may be made by AMs.</P>
<P>The "name" property values are intended to be seen by Alice when she maps 
authorization constraints to specific resource sets and actions while visiting 
CopMonkey, such that Alice would see the strings "View Photo and Related Info" 
and "All Actions", likely accompanied by the referenced icons, in the CopMonkey 
interface. (Other users of Photoz might similarly see the same labels at 
CopMonkey or whatever other AM they use. Photoz could distinguish 
natural-language labels per user if it wishes, by pointing to scopes with 
differently translated names.)</P>
<P>Example of the viewing-related scope description document available at 
http://photoz.example.com/dev/scopes/view with a Content-Type of 
application/uma-scope+json:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
  "name": "View Photo and Related Info",
  "icon_uri": "http://www.example.com/icons/reading-glasses.png"
}
</PRE></DIV>
<P>Example of the broader scope description document available at 
http://photoz.example.com/dev/scopes/all, likewise with a Content-Type of 
application/uma-scope+json:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
  "name": "All Actions",
  "icon_uri": "http://www.example.com/icons/galaxy.png"
}
</PRE></DIV>
<P>While visiting Photoz, Alice selects a link or button that instructs the site 
to "Protect" or "Share" this single photo (user experience only; Photoz could 
have made this a default or preference setting).</P>
<P>As a result, Photoz defines for itself a resource set that represents this 
photo (internal only; Photoz is the only application that knows how to map a 
particular photo to a particular resource set). Photoz also prepares the 
following resource set description, which is specific to Alice and her photo. 
The "name" property value is intended to be seen by Alice in mapping 
authorization policies to specific resource sets and actions when she visits 
CopMonkey. Alice would see the string "Steve the puppy!", likely accompanied by 
the referenced icon, in the CopMonkey interface. The possible scopes of access 
on this resource set are indicated with URI references to the scope 
descriptions, as shown just above.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
  "name": "Steve the puppy!",
  "icon_uri": "http://www.example.com/icons/flower",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}
</PRE></DIV>
<P>Photoz uses the "create resource set description" method of CopMonkey's 
standard UMA resource set registration API, presenting its Alice-specific host 
access token there, to register and assign an identifier to the resource set 
description.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /resource_set/112210f47de98100 HTTP/1.1
Content-Type: application/uma-resource-set+json
...

{
  "name": "Steve the puppy!",
  "icon_uri": "http://www.example.com/icons/flower.png",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}
</PRE></DIV>
<P>If the registration attempt succeeds, CopMonkey responds in the following 
fashion.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/uma-status+json
ETag: "1"
...

{
  "status": "created",
  "_id":  "112210f47de98100",
  "_rev": "1"
}
</PRE></DIV>
<P>At the time Alice indicates she would like this photo protected, Photoz can 
choose to redirect Alice to CopMonkey for further policy setting, access 
auditing, and other AM-related tasks (user experience only).</P>
<P>Once it has successfully registered this description, Photoz is responsible 
for outsourcing to CopMonkey all questions of authorization for access attempts 
made to this photo.</P>
<P>Over time, as Alice uploads other photos and creates and organizes photo 
albums, and as Photoz makes new action functionality available, Photoz can use 
additional methods of the resource set registration API to ensure that 
CopMonkey's understanding of Alice's protected resources matches its own.</P>
<P>For example, if Photoz suspects that somehow its understanding of the 
resource set has gotten out of sync with CopMonkey's, it can ask to read the 
resource set description as follows.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /resource_set/112210f47de98100 HTTP/1.1
Host: am.example.com
...
</PRE></DIV>
<P>CopMonkey responds with the full content of the resource set description, 
including its _id and its current _rev, as follows:</P>
<P>Example of an HTTP response to a "read resource set description" request, 
containing a resource set description from the AM:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/uma-resource-set+json
ETag: "1"
...

{
  "_id":  "112210f47de98100",
  "_rev": "1",
  "name": "Photo album",
  "icon_uri": "http://www.example.com/icons/flower.png",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}
</PRE></DIV>
<P>If for some reason Photoz and CopMonkey have gotten dramatically out of sync, 
Photoz can ask for the list of resource set identifiers CopMonkey currently 
knows about:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /resource_set HTTP/1.1
Host: am.example.com
...
</PRE></DIV>
<P>CopMonkey's response might look as follows:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/json
...

[ "112210f47de98100", "34234df47eL95300" ]
</PRE></DIV>
<P>If Alice later changes the photo's title (user experience only) on Photoz 
from "Steve the puppy!" to "Steve on October 14, 2011", Photoz would use the 
"update resource set description" method to ensure that Alice's experience of 
policy-setting at CopMonkey remains consistent with what she sees at Photoz. 
Following is an example of this request.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /resource_set/112210f47de98100 HTTP/1.1
Content-Type: application/uma-resource-set+json
Host: am.example.com
If-Match: "1"
...

{
  "name": "Steve on October 14, 2011",
  "icon_uri": "http://www.example.com/icons/flower.png",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}
</PRE></DIV>
<P>CopMonkey would respond as follows.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/uma-status+json
ETag: "2"
...

{
  "status": "updated",
  "_id":  "112210f47de98100",
  "_rev": "2"
}
</PRE></DIV>
<P>There are other reasons Photoz might want to update resource set 
descriptions, having nothing to do with Alice's actions or wishes. For example, 
it might extend its API to include new features, and want to add new scopes to 
all of Alice's and other users' resource set descriptions.</P>
<P>if Alice later decides to entirely remove sharing protection (user experience 
only) on this photo while visiting Photoz, ensuring that the public can get 
access without any UMA-based protection, Photoz is responsible for deleting the 
relevant resource set registration, as follows:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>DELETE /resource_set/112210f47de98100 HTTP/1.1
Host: am.example.com
If-Match: "2"
...
</PRE></DIV>
<A name="Acknowledgments"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.11"></A>
<H3>11.&nbsp; Acknowledgments</H3>
<P>The current editor of this specification is Thomas Hardjono of MIT. The 
following people are co-authors:</P>
<UL class="text">
  <LI>Paul C. Bryan, ForgeRock US, Inc. (former editor)</LI>
  <LI>Domenico Catalano, Oracle Corp.</LI>
  <LI>Maciej Machulak, Newcastle University</LI>
  <LI>Eve Maler, XMLgrrl.com</LI>
  <LI>Lukasz Moren, Newcastle University</LI>
  <LI>Christian Scholz, COMlounge GmbH (former editor)</LI></UL>
<P>Additional contributors to this specification include the Kantara UMA Work 
Group participants, a list of whom can be found at <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#UMAnitarians">[UMAnitarians]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Participant Roster,” 
2011.</SPAN><SPAN>)</SPAN></A>.</P><A name="anchor7"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.12"></A>
<H3>12.&nbsp; Issues</H3>
<P>All issues are now captured at the project's GitHub site (<A href="https://github.com/xmlgrrl/UMA-Specifications/issues">https://github.com/xmlgrrl/UMA-Specifications/issues</A>).
</P><A name="rfc.references"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.13"></A>
<H3>13.&nbsp; References</H3><A name="rfc.references1"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<H3>13.1.&nbsp;Normative References</H3>
<TABLE border="0" width="99%">
  <TBODY>
  <TR>
    <TD class="author-text" vAlign="top"><A 
    name="OAuth-SAML">[OAuth-SAML]</A></TD>
    <TD class="author-text">Campbell, B., “<A href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-08">SAML 
      2.0 Bearer Assertion Grant Type Profile for OAuth 2.0</A>,” 
      August&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="OAuth-bearer">[OAuth-bearer]</A></TD>
    <TD class="author-text">Jones, M., “<A href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-06">The 
      OAuth 2.0 Protocol: Bearer Tokens</A>,” June&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="OAuth2">[OAuth2]</A></TD>
    <TD class="author-text">Hammer-Lahav, E., “<A href="http://tools.ietf.org/html/draft-ietf-oauth-v2">The 
      OAuth 2.0 Protocol</A>,” September&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="OCDynClientReg">[OCDynClientReg]</A></TD>
    <TD class="author-text">Sakimura, N., “<A href="http://openid.net/specs/openid-connect-registration-1_0.html">OpenID 
      Connect Dynamic Client Registration 1.0</A>,” September&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
    name="OCMessages">[OCMessages]</A></TD>
    <TD class="author-text">Sakimura, N., “<A href="http://openid.net/specs/openid-connect-messages-1_0.html">OpenID 
      Connect Messages 1.0</A>,” September&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
    name="OCStandard">[OCStandard]</A></TD>
    <TD class="author-text">Sakimura, N., “<A href="http://openid.net/specs/openid-connect-standard-1_0.html">OpenID 
      Connect Standard 1.0</A>,” September&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="RFC2119">[RFC2119]</A></TD>
    <TD class="author-text"><A href="mailto:sob@harvard.edu">Bradner, S.</A>, 
      “<A href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to 
      Indicate Requirement Levels</A>,” BCP&nbsp;14, RFC&nbsp;2119, 
      March&nbsp;1997 (<A 
      href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</A>, <A href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</A>, 
      <A 
  href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</A>).</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="RFC4627">[RFC4627]</A></TD>
    <TD class="author-text">Crockford, D., “<A href="http://tools.ietf.org/html/rfc4627">The 
      application/json Media Type for JavaScript Object Notation (JSON)</A>,” 
      RFC&nbsp;4627, July&nbsp;2006 (<A href="http://www.rfc-editor.org/rfc/rfc4627.txt">TXT</A>).</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="hostmeta">[hostmeta]</A></TD>
    <TD class="author-text">Hammer-Lahav, E., “<A href="http://tools.ietf.org/html/draft-hammer-hostmeta-16">Web 
      Host Metadata</A>,” May&nbsp;2011.</TD></TR></TBODY></TABLE><A name="rfc.references2"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<H3>13.2.&nbsp;Informative References</H3>
<TABLE border="0" width="99%">
  <TBODY>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMA-trustmodel">[UMA-trustmodel]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/UMA+Trust+Model">UMA 
      Trust Model</A>,” February&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMA-usecases">[UMA-usecases]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/UMA+Scenarios+and+Use+Cases">UMA 
      Scenarios and Use Cases</A>,” October&nbsp;2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMA-userstories">[UMA-userstories]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/User+Stories">UMA 
      User Stories</A>,” November&nbsp;2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMAnitarians">[UMAnitarians]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/Participant+Roster">UMA 
      Participant Roster</A>,” 2011.</TD></TR></TBODY></TABLE><A 
name="History"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.A"></A>
<H3>Appendix A.&nbsp; Document History</H3>
<P>NOTE: To be removed by RFC editor before publication as an RFC.</P><A name="rfc.authors"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-3593462367388776219.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<H3>Author's Address</H3>
<TABLE border="0" cellSpacing="0" cellPadding="0" width="99%">
  <TBODY>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Thomas Hardjono (editor)</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">MIT</TD></TR>
  <TR>
    <TD class="author" align="right">Email:&nbsp;</TD>
    <TD class="author-text"><A 
      href="mailto:hardjono@mit.edu">hardjono@mit.edu</A></TD></TR>
</TBODY></TABLE></BODY></HTML>
