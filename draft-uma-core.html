<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>User-Managed Access (UMA) Profile of OAuth 2.0</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="User-Managed Access (UMA) Profile of OAuth 2.0">
<meta name="generator" content="xml2rfc v1.36 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">T. Hardjono, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">MIT</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">December 28, 2012</td></tr>
<tr><td class="header">Expires: July 1, 2013</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />User-Managed Access (UMA) Profile of OAuth 2.0<br />draft-hardjono-oauth-umacore-07a</h1>

<h3>Abstract</h3>

<p>User-Managed Access (UMA) is a profile of OAuth 2.0. UMA defines how resource owners can control protected-resource access by clients operated by arbitrary requesting parties, where the resources reside on any number of resource servers, and where a centralized authorization server governs access based on resource owner policy.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 1, 2013.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2012 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Notational Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">1.2.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#endpoint-discussion">1.3.</a>&nbsp;
APIs and Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.3.1.</a>&nbsp;
Protection and Authorization APIs at the Authorization Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.3.2.</a>&nbsp;
API at the Resource Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#am-endpoints">1.4.</a>&nbsp;
Authorization Server Configuration Data<br />
<a href="#protecting-a-resource">2.</a>&nbsp;
Protecting a Resource<br />
<a href="#getting-authz-accessing-resource">3.</a>&nbsp;
Getting Authorization and Accessing a Resource<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#r-h-attempt-access">3.1.</a>&nbsp;
Client Attempts to Access Protected Resource<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#no-rpt">3.1.1.</a>&nbsp;
Client Presents No RPT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#client-presents-rpt">3.1.2.</a>&nbsp;
Client Presents RPT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#h-am-register-permission">3.2.</a>&nbsp;
Resource Server Registers Requested Permission With Authorization Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#h-am-rpt-status">3.3.</a>&nbsp;
Resource Server Determines RPT's Status<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#token-introspection">3.3.1.</a>&nbsp;
Token Introspection<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uma-bearer-token-profile">3.3.2.</a>&nbsp;
UMA Bearer Token Profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#r-am-obtain-permission">3.4.</a>&nbsp;
Client Seeks Authorization for Access<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#authz-permission-token">3.4.1.</a>&nbsp;
Client Obtains RPT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#r-am-authz-scope">3.4.2.</a>&nbsp;
Client Asks for Authorization Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#authz-flows">3.5.</a>&nbsp;
Claims-Gathering Flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#trusted-claims-human-driven">3.5.1.</a>&nbsp;
Claims-Gathering Flow for Clients Operated by End-Users<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#trusted-claims">3.5.1.1.</a>&nbsp;
OpenID Connect Claim Profile<br />
<a href="#errors">4.</a>&nbsp;
Error Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oauth-error-response">4.1.</a>&nbsp;
OAuth Error Responses<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uma-error-response">4.2.</a>&nbsp;
UMA Error Responses<br />
<a href="#profiles">5.</a>&nbsp;
Specificying Additional Profiles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">5.1.</a>&nbsp;
Specifying Profiles of UMA<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">5.2.</a>&nbsp;
Specifying RPT Profiles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.3.</a>&nbsp;
Specifying Claim Profiles<br />
<a href="#anchor7">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor8">7.</a>&nbsp;
Privacy Considerations<br />
<a href="#conformance">8.</a>&nbsp;
Conformance<br />
<a href="#IANA">9.</a>&nbsp;
IANA Considerations<br />
<a href="#Acknowledgments">10.</a>&nbsp;
Acknowledgments<br />
<a href="#anchor9">11.</a>&nbsp;
Issues<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#History">Appendix&nbsp;A.</a>&nbsp;
Document History<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>User-Managed Access (UMA) is a profile of OAuth 2.0 <a class='info' href='#OAuth2'>[OAuth2]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a>. UMA defines how resource owners can control protected-resource access by clients operated by arbitrary requesting parties, where the resources reside on any number of resource servers, and where a centralized authorization server governs access based on resource owner policy. Resource owners configure authorization servers with access policies that serve as implicit authorization grants. Thus, the UMA profile of OAuth includes an authorization grant flow.
</p>
<p>UMA serves numerous use cases where a resource owner outsources authorization for access to their resources, potentially even without the run-time presence of the resource owner. A typical example is the following: a web user (an end-user resource owner) can authorize a web app (client) to gain one-time or ongoing access to a protected resource containing his home address stored at a "personal data store" service (resource server), by telling the resource server to respect access entitlements issued by his chosen cloud-based authorization service (authorization server). The requesting party operating the client might be the resource owner himself, using a web or native app run by an e-commerce company that needs to know where to ship a purchased item, or it might be his friend who is using an online address book service to collect contact information, or it might be a survey company that uses an autonomous web service to compile population demographics. A variety of scenarios and use cases can be found in <a class='info' href='#UMA-usecases'>[UMA&#8209;usecases]<span> (</span><span class='info'>Maler, E., &ldquo;UMA Scenarios and Use Cases,&rdquo; October&nbsp;2010.</span><span>)</span></a> and <a class='info' href='#UMA-casestudies'>[UMA&#8209;casestudies]<span> (</span><span class='info'>Maler, E., &ldquo;UMA Case Studies,&rdquo; December&nbsp;2012.</span><span>)</span></a>.
</p>
<p>Practical control of access among loosely coupled parties requires more than just messaging protocols. This specification defines only the technical "contract" between UMA-conforming entities; its companion Binding Obligations specification <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a> defines the expected behaviors of parties operating and using these entities. Parties operating entities that claim to be UMA-conforming MUST provide documentation affirmatively stating their acceptance of the binding obligations contractual framework defined in the Binding Obligations specification.
</p>
<p>In enterprise settings, application access management sometimes involves letting back-office applications serve only as policy enforcement points (PEPs), depending entirely on access decisions coming from a central policy decision point (PDP) to govern the access they give to requesters. This separation eases auditing and allows policy administration to scale in several dimensions. UMA makes use of a separation similar to this, letting the resource owner serve as a policy administrator crafting authorization strategies for resources under their control.
</p>
<p>In order to increase interoperable communication among the authorization server, resource server, and client, UMA defines several purpose-built APIs related to the outsourcing of authorization, themselves protected by OAuth in embedded fashion.
</p>
<p>The UMA protocol has three broad phases, as shown in <a class='info' href='#UMA-phases'>Figure&nbsp;1</a>.
</p><br /><hr class="insert" />
<a name="UMA-phases"></a>

<p style='text-align: center'>The Three Phases of the UMA Profile of OAuth
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>                                           +--------------+
                                           |   resource   |
          +---------manage (A)------------ |     owner    |
          |                                +--------------+
          |         Phase 1:                      |
          |         protect a                control (B)
          |         resource                      |
          v                                       v
   +------------+               +----------+--------------+
   |            |               |protection|              |
   |  resource  |               |   API    | authorization|
   |   server   |&lt;-protect (C)--|  (needs  |    server    |
   |            |               |   PAT)   |              |
   +------------+               +----------+--------------+
   | protected  |                          | authorization|
   | resource   |                          |     API      |
   |(needs RPT) |                          |  (needs AAT) |
   +------------+                          +--------------+
          ^                                       |
          |         Phases 2 and 3:         authorize (D)
          |         get authorization,            |
          |         access a resource             v
          |                                +--------------+
          +---------access (E)-------------|    client    |
                                           +--------------+

                                           requesting party
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The phases work as follows: </p>
<blockquote class="text"><dl>
<dt>Protect a resource</dt>
<dd>(Described in <a class='info' href='#protecting-a-resource'>Section&nbsp;2<span> (</span><span class='info'>Protecting a Resource</span><span>)</span></a>.) The resource owner, who manages online resources at the resource server ("A"), introduces it to the authorization server so that the latter can begin controlling the resources' protection. To accomplish this protection, the authorization server presents a protection API ("C") to the resource server. This API is OAuth-protected and requires a protection API token (PAT) for access. The API consists of an OAuth resource set registration endpoint as defined by <a class='info' href='#OAuth-resource-reg'>[OAuth&#8209;resource&#8209;reg]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 Resource Set Registration,&rdquo; December&nbsp;2012.</span><span>)</span></a>, an endpoint for registering client-requested permissions, and an OAuth token introspection endpoint as defined by <a class='info' href='#OAuth-introspection'>[OAuth&#8209;introspection]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Token Introspection,&rdquo; November&nbsp;2012.</span><span>)</span></a>. Out of band, the resource owner configures the authorization server with policies associated with the registered resource sets ("B").
</dd>
<dt>Get authorization</dt>
<dd>(Described in <a class='info' href='#getting-authz-accessing-resource'>Section&nbsp;3<span> (</span><span class='info'>Getting Authorization and Accessing a Resource</span><span>)</span></a>.) The client approaches the resource server seeking access to a protected resource. In order to access it successfully, the client must first use the authorization server's authorization API ("D") to obtain a requesting party token (RPT) on behalf of its requesting party, and the requesting party must supply to the authorization server any identity claims needed in order for the server to associate sufficient authorization data with that RPT. The API is OAuth-protected and requires an authorization API token (AAT) for access. The API consists of an RPT issuance endpoint and an authorization request endpoint.
</dd>
<dt>Access a resource</dt>
<dd>(Described along with Phase 2 in <a class='info' href='#getting-authz-accessing-resource'>Section&nbsp;3<span> (</span><span class='info'>Getting Authorization and Accessing a Resource</span><span>)</span></a>.) The client successfully presents an RPT that has sufficient authorization data associated with it to the resource server, gaining access to the desired resource ("E"). In this sense, this phase is the "happy path" within phase 2. The nature of the authorization data varies according to the RPT profile in use.
</dd>
</dl></blockquote>

<p>Implementers are anticipated to develop profiles (see <a class='info' href='#profiles'>Section&nbsp;5<span> (</span><span class='info'>Specificying Additional Profiles</span><span>)</span></a>) that specify and restrict various UMA protocol, RPT, and identity claim options, according to deployment and usage conditions.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Notational Conventions</h3>

<p>The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Unless otherwise noted, all the protocol properties and values are case sensitive.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>UMA introduces the following new terms and enhancements of OAuth term definitions.</p>
<blockquote class="text"><dl>
<dt>resource owner</dt>
<dd>An OAuth resource that is the "user" in User-Managed Access. This is typically an end-user (a natural person) but it can also be a corporation or other legal person.
</dd>
<dt>requesting party</dt>
<dd>An end-user, or a corporation or other legal person, that uses a client to seek access to a protected resource. The requesting party may or may not be the same party as the resource owner.
</dd>
<dt>client</dt>
<dd>An application making protected resource requests with the resource owner's authorization and on the requesting party's behalf.
</dd>
<dt>claim</dt>
<dd>A statement of the value or values of one or more identity attributes of a requesting party. A requesting party may need to provide claims to an authorization server in order to satisfy policy and gain permission for access to a protected resource.
</dd>
<dt>resource set</dt>
<dd>A set of one or more protected resources. In authorization policy terminology, a resource set is the "object" being protected.
</dd>
<dt>scope</dt>
<dd>A bounded extent of access that is possible to perform on a resource set. In authorization policy terminology, a scope is one of the potentially many "verbs" that can logically apply to a resource set ("object"). UMA associates scopes with labeled resource sets.
</dd>
<dt>authorization data</dt>
<dd>Data associated with a requesting party token that enables some combination of the authorization server and resource server to determine the correct extent of access to allow to a client. Authorization data is a key part of the definition of an RPT profile.
</dd>
<dt>permission</dt>
<dd>A scope of access over a particular resource set at a particular resource server that is being requested by, or granted to, a requesting party. In authorization policy terminology, a permission is an entitlement that includes a "subject" (requesting party), "verbs" (one or more scopes of access), and an "object" (resource set). A permission is one example of authorization data that an authorization server may issue.
</dd>
<dt>permission ticket</dt>
<dd>A correlation handle that is conveyed from an authorization server to a resource server, from a resource server to a client, and ultimately from a client to an authorization server, to enable the authorization server to assess the correct resource owner policies to apply to a request for an authorization grant.
</dd>
</dl></blockquote>

<a name="endpoint-discussion"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
APIs and Protection</h3>

<p>UMA involves three APIs, all of which are protected.
</p>
<p>The authorization server has the opportunity to manage the validity periods of access tokens that it issues, their corresponding refresh tokens where applicable, the individual data components associated with RPTs where applicable, and even the client credentials that it issues. Different time-to-live strategies may be suitable for different resources and scopes of access, and the authorization server has the opportunity to give the resource owner control over lifetimes of tokens and authorization data issued on their behalf through policy. These options are all outside the scope of this specification.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3.1"></a><h3>1.3.1.&nbsp;
Protection and Authorization APIs at the Authorization Server</h3>

<p>The authorization server presents a protection API to the resource server and an authorization API to the client. These APIs MUST be OAuth-protected; thus, the authorization server has an OAuth token endpoint and user authorization endpoint, and has the option to issue an OAuth refresh token along with any access tokens issued for these APIs.
</p>
<p>The protection API consists of an OAuth resource set registration endpoint as defined by <a class='info' href='#OAuth-resource-reg'>[OAuth&#8209;resource&#8209;reg]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 Resource Set Registration,&rdquo; December&nbsp;2012.</span><span>)</span></a>, an endpoint for registering client-requested permissions, and an OAuth token introspection endpoint as defined by <a class='info' href='#OAuth-introspection'>[OAuth&#8209;introspection]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Token Introspection,&rdquo; November&nbsp;2012.</span><span>)</span></a>. This specification profiles the endpoints defined by these other specifications.
</p>
<p>The authorization API consists of an RPT issuance endpoint and an authorization request endpoint.
</p>
<p>All endpoint URIs SHOULD require the use of a transport-layer security mechanism such as TLS. The authorization server MUST declare all of its endpoints in its configuration data (see <a class='info' href='#am-endpoints'>Section&nbsp;1.4<span> (</span><span class='info'>Authorization Server Configuration Data</span><span>)</span></a>).
</p>
<p>An entity seeking protection API access MUST request the scope "http://docs.kantarainitiative.org/uma/scopes/prot.json", and an access token with at least this scope is called a protection API token (PAT). An entity seeking authorization API access MUST request the scope "http://docs.kantarainitiative.org/uma/scopes/authz.json", and an access token with at least this scope is called an authorization API token (AAT). The same entity can serve in both roles, so that an OAuth access token might be considered both a PAT and an AAT if it has both scopes. If a request to an endpoint fails due to an invalid, missing, or expired PAT or AAT, or requires higher privileges at this endpoint than provided by the PAT or AAT, the authorization server responds with an OAuth error.
</p>
<p>Note: These scope keywords are URIs that resolve to JSON-encoded scope descriptions, as defined in <a class='info' href='#OAuth-resource-reg'>[OAuth&#8209;resource&#8209;reg]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 Resource Set Registration,&rdquo; December&nbsp;2012.</span><span>)</span></a>. These scope descriptions are non-normative for the purposes of PATs and AATs.
</p>
<p>The authorization server is REQUIRED to support the OAuth bearer token profile for PAT and AAT issuance, and MAY support other OAuth token profiles for these purposes. It MUST declare all supported token profiles for PAT and AAT issuance in its configuration data. The authorization server MAY support the use of any OAuth grant type for PAT and AAT issuance, but MUST support the authorization_code grant type, and SHOULD support the SAML bearer token grant type <a class='info' href='#OAuth-SAML'>[OAuth&#8209;SAML]<span> (</span><span class='info'>Campbell, B., &ldquo;SAML 2.0 Bearer Assertion Profiles for OAuth 2.0,&rdquo; November&nbsp;2012.</span><span>)</span></a> (urn:ietf:params:oauth:grant-type:saml2-bearer) if it anticipates working with entities that are operating in environments where the use of SAML is prevalent. It MUST declare its supported grant types for PAT and AAT issuance in its configuration data.
</p>
<p>A PAT binds a resource owner, a resource server the owner uses for resource management, and an authorization server the owner uses for protection of resources at this resource server. It is not specific to any client or requesting party. The issuance of a PAT represents the approval of the resource owner for this resource server to trust this authorization server for protecting its resources belonging to this resource owner.
</p>
<p>An AAT binds a requesting party, a client being used by that party, and an authorization server that protects resources this client is seeking access to on this requesting party's behalf. It is not specific to any resource server or resource owner. The issuance of an AAT represents the approval of this requesting party for this client to engage with this authorization server to supply claims, ask for authorization, and perform any other tasks needed for obtaining authorization for access to resources at all resource servers that use this authorization server. The authorization server is able to manage future processes of authorization and claims-caching efficiently for this client/requesting party pair across all resource servers they try to access. These management processes are outside the scope of this specification, however.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3.2"></a><h3>1.3.2.&nbsp;
API at the Resource Server</h3>

<p>The resource server presents one or more protected resource endpoints to the client; these endpoints are protected by the UMA profile of OAuth and require a requesting party token (RPT) with sufficient authorization data for access. This specification defines one RPT profile, call "bearer" (see <a class='info' href='#uma-bearer-token-profile'>Section&nbsp;3.3.2<span> (</span><span class='info'>UMA Bearer Token Profile</span><span>)</span></a>), which is REQUIRED for the authorization server to support. It MAY support additional RPT profiles. It MUST declare all supported RPT profiles in its configuration data.
</p>
<p>An RPT represents a binding of a requesting party, the client being used by that party, the resource server at which protected resources of interest reside, and the authorization server that protects those resources. It is not specific to a single resource owner, though its internal components are likely to be bound to individual resource owners, depending on the RPT profile in use.
</p>
<a name="am-endpoints"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Authorization Server Configuration Data</h3>

<p>The authorization server MUST provide configuration data in a JSON <a class='info' href='#RFC4627'>[RFC4627]<span> (</span><span class='info'>Crockford, D., &ldquo;The application/json Media Type for JavaScript Object Notation (JSON),&rdquo; July&nbsp;2006.</span><span>)</span></a> document that resides in an /uma-configuration directory at at its hostmeta <a class='info' href='#hostmeta'>[hostmeta]<span> (</span><span class='info'>Hammer-Lahav, E., &ldquo;Web Host Metadata,&rdquo; October&nbsp;2011.</span><span>)</span></a> location. The configuration data documents conformance options and endpoints supported by the authorization server. (At the appropriate time, this section will instead profile whatever self-describing metadata specification OAuth adopts, for example, <a class='info' href='#OAuth-linktypes'>[OAuth&#8209;linktypes]<span> (</span><span class='info'>Mills, W., &ldquo;Link Type Registrations for OAuth 2,&rdquo; October&nbsp;2012.</span><span>)</span></a> or <a class='info' href='#OAuth-meta'>[OAuth&#8209;meta]<span> (</span><span class='info'>Sakimura, N., &ldquo;JSON Metadata for OAuth Responses,&rdquo; December&nbsp;2012.</span><span>)</span></a>.)
</p>
<p>The configuration data has the following properties.</p>
<blockquote class="text"><dl>
<dt>version</dt>
<dd>REQUIRED. The version of the UMA core protocol to which this authorization server conforms. The value MUST be the string "1.0".
</dd>
<dt>issuer</dt>
<dd>REQUIRED. A URI indicating the party operating the authorization server.
</dd>
<dt>oauth_token_profiles_supported</dt>
<dd>REQUIRED. PAT and AAT profiles produced by this authorization server. The property value is an array of string values. Currently the only string value for this property defined by this specification is "bearer", corresponding to the OAuth bearer token profile <a class='info' href='#OAuth-bearer'>[OAuth&#8209;bearer]<span> (</span><span class='info'>, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; October&nbsp;2012.</span><span>)</span></a>. The authorization server is REQUIRED to support this profile, and to supply this string value explicitly. The authorization server MAY declare its support for additional access token profiles by providing a unique absolute URI in a string value in the array for each one.
</dd>
<dt>uma_token_profiles_supported</dt>
<dd>REQUIRED. RPT profiles produced by this authorization server. The property value is an array of string values. Currently the only string value for this property defined by this specification is "bearer", whose associations the resource server MUST determine through a token introspection interaction with the authorization server (see <a class='info' href='#h-am-rpt-status'>Section&nbsp;3.3<span> (</span><span class='info'>Resource Server Determines RPT's Status</span><span>)</span></a> for the definition of this profile). The authorization server is REQUIRED to support the UMA bearer token profile, and to supply this string value explicitly. The authorization server MAY declare its support for RPTs using additional RPT profiles by providing a unique absolute URI in a string value in the array for each one.
</dd>
<dt>oauth_grant_types_supported</dt>
<dd>REQUIRED. OAuth grant types supported by this authorization server in issuing PATs and AATs. The property value is an array of string values. Each string value MUST be one of the grant_type values defined in <a class='info' href='#OAuth2'>[OAuth2]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a>, or alternatively an extension grant type indicated by a unique absolute URI.
</dd>
<dt>claim_profiles_supported</dt>
<dd>OPTIONAL. Claim formats and associated sub-protocols for gathering claims from requesting parties, as supported by this authorization server. The property value is an array of string values. Currently the only string value for this property defined by this specification is "openid", for which details are supplied in <a class='info' href='#trusted-claims'>Section&nbsp;3.5.1.1<span> (</span><span class='info'>OpenID Connect Claim Profile</span><span>)</span></a>. The authorization server MAY declare its support for additional claim profiles by assigning a unique absolute URI in a string value in the array for each one.
</dd>
<dt>dynamic_client_endpoint</dt>
<dd>OPTIONAL. The endpoint to use for performing dynamic client registration. Usage is defined by <a class='info' href='#DynClientReg'>[DynClientReg]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Dynamic Client Registration Protocol,&rdquo; November&nbsp;2012.</span><span>)</span></a>.
</dd>
<dt>token_endpoint</dt>
<dd>REQUIRED. The endpoint URI at which the resource server or client asks the authorization server for a PAT or AAT, respectively. A requested scope of "http://docs.kantarainitiative.org/uma/scopes/prot.json" results in a PAT. A requested scope of "http://docs.kantarainitiative.org/uma/scopes/authorization" results in an AAT. Usage is defined by <a class='info' href='#OAuth2'>[OAuth2]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a>.
</dd>
<dt>user_endpoint</dt>
<dd>REQUIRED. The endpoint URI at which the resource server gathers the consent of the end-user resource owner or the client gathers the consent of the end-user requesting party, if the "authorization_code" grant type is used. Usage is defined by <a class='info' href='#OAuth2'>[OAuth2]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a>.
</dd>
<dt>introspection_endpoint</dt>
<dd>REQUIRED. The endpoint URI at which the resource server introspects an RPT presented to it by a client. Usage is defined by <a class='info' href='#OAuth-introspection'>[OAuth&#8209;introspection]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Token Introspection,&rdquo; November&nbsp;2012.</span><span>)</span></a> and <a class='info' href='#token-introspection'>Section&nbsp;3.3.1<span> (</span><span class='info'>Token Introspection</span><span>)</span></a>. A valid PAT MUST accompany requests to this protected endpoint.
</dd>
<dt>resource_set_registration</dt>
<dd>REQUIRED. The endpoint URI at which the resource server registers resource sets to put them under authorization manager protection. Usage is defined by <a class='info' href='#OAuth-resource-reg'>[OAuth&#8209;resource&#8209;reg]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 Resource Set Registration,&rdquo; December&nbsp;2012.</span><span>)</span></a> and <a class='info' href='#protecting-a-resource'>Section&nbsp;2<span> (</span><span class='info'>Protecting a Resource</span><span>)</span></a>. A valid PAT MUST accompany requests to this protected endpoint.
</dd>
<dt>permission_registration_endpoint</dt>
<dd>REQUIRED. The endpoint URI at which the resource server registers a client-requested permission with the authorization server. Usage is defined by <a class='info' href='#h-am-register-permission'>Section&nbsp;3.2<span> (</span><span class='info'>Resource Server Registers Requested Permission With Authorization Server</span><span>)</span></a>. A valid PAT MUST accompany requests to this protected endpoint.
</dd>
<dt>rpt_endpoint</dt>
<dd>REQUIRED. The endpoint URI at which the client asks the authorization server for an RPT. Usage is defined by <a class='info' href='#authz-permission-token'>Section&nbsp;3.4.1<span> (</span><span class='info'>Client Obtains RPT</span><span>)</span></a>. A valid AAT MUST accompany requests to this protected endpoint.
</dd>
<dt>authorization_request_endpoint</dt>
<dd>REQUIRED. The endpoint URI at which the client asks, on its requesting party's behalf, to have authorization data associated with its RPT. Usage is defined in <a class='info' href='#r-am-authz-scope'>Section&nbsp;3.4.2<span> (</span><span class='info'>Client Asks for Authorization Data</span><span>)</span></a>. A valid AAT MUST accompany requests to this protected endpoint.
</dd>
</dl></blockquote>

<p>Example of authorization server configuration data that resides at https://example.com/.well-known/uma-configuration (note the use of https: for endpoints throughout):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{
"version":"1.0",
"issuer":"https://example.com",
"oauth_token_profiles_supported":[
  "bearer"
],
"uma_token_profiles_supported":[
  "bearer"
],
"oauth_grant_types_supported":[
  "authorization_code"
],
"claim_profiles_supported":[
  "openid"
],
"dynamic_client_endpoint":"https://as.example.com/dyn_client_reg_uri",
"token_endpoint":"https://as.example.com/token_uri",
"user_endpoint":"https://as.example.com/user_uri",
"resource_set_registration_endpoint":"https://as.example.com/rs/rsrc_uri",
"introspection_endpoint":"https://as.example.com/rs/status_uri",
"permission_registration_endpoint":"https://as.example.com/rs/perm_uri",
"rpt_endpoint":"https://as.example.com/client/rpt_uri",
"authorization_request_endpoint":"https://as.example.com/client/perm_uri"
}</pre></div>
<p>Authorization server configuration data MAY contain extension properties that are not defined in this specification. Extension names that are unprotected from collisions are outside the scope of this specification.
</p>
<a name="protecting-a-resource"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Protecting a Resource</h3>

<p>The resource owner, resource server, and authorization server perform the following actions to put resources under protection. This list assumes that the resource server has discovered the authorization server's configuration data and endpoints as needed.</p>
<ol class="text">
<li>The authorization server issues client credentials to the resource server. It is OPTIONAL for the client credentials to be provided dynamically through <a class='info' href='#DynClientReg'>[DynClientReg]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Dynamic Client Registration Protocol,&rdquo; November&nbsp;2012.</span><span>)</span></a>); alternatively, they MAY use a static process.
</li>
<li>The resource server acquires a PAT from the authorization server in order to use the resource set registration endpoint (and later, other protection API endpoints). It is OPTIONAL for the resource owner to introduce the resource server to the authorization server dynamically (for example, through a "NASCAR"-style user interface where the resource owner selects a chosen authorization server); alternatively, they MAY use a static process that may or may not directly involve the resource owner at introduction time.
</li>
<li>In an ongoing fashion, the resource server registers any resource sets with the authorization server for which it intends to outsource protection, using the process defined by <a class='info' href='#OAuth-resource-reg'>[OAuth&#8209;resource&#8209;reg]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 Resource Set Registration,&rdquo; December&nbsp;2012.</span><span>)</span></a>.
</li>
</ol>

<p>Note: The resource server is free to offer the option to protect any subset of the resource owner's resources using different authorization servers or other means entirely, or to protect some resources and not others. Additionally, the choice of protection regimes can be made explicitly by the resource owner or implicitly by the resource server. Any such partitioning by the resource server or owner is outside the scope of this specification.
</p>
<p>Once a resource set has been placed under authorization server protection through the registration of a resource set description for it, and until such a description's deletion by the resource server, the resource server MUST limit access to corresponding resources, respecting authorization data associated with client-presented RPTs by the authorization server as appropriate (see <a class='info' href='#client-presents-rpt'>Section&nbsp;3.1.2<span> (</span><span class='info'>Client Presents RPT</span><span>)</span></a>).
</p>
<a name="getting-authz-accessing-resource"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Getting Authorization and Accessing a Resource</h3>

<p>An authorization server orchestrates and controls clients' access (on their requesting parties' behalf) to a resource owner's protected resources at a resource server, under conditions dictated by that resource owner.
</p>
<p>The process of getting authorization and accessing a resource always begins with the client attempting access at a protected resource endpoint at the resource server. How the client came to learn about this endpoint is out of scope for this specification. The resource owner might, for example, have advertised its availability publicly on a blog or other website, listed it in a discovery service, or emailed a link to a particular intended requesting party.
</p>
<p>The resource server responds to the client's access request in one of several ways depending on the circumstances of the request, either immediately or having first performed one or more embedded interactions with the authorization server. Depending on the nature of the resource server's response to an failed access attempt, the client and its requesting party engage in embedded interactions with the authorization server before re-attempting access.
</p>
<p>The interactions are as follows. Each interaction MAY be the last, if the client chooses not to continue pursuing the access attempt or the resource server chooses not to continue facilitating it.</p>
<ul class="text">
<li>The client attempts to access a protected resource.
<ul class="text">
<li>If the access attempt is unaccompanied by an RPT, the resource server responds immediately with an HTTP 401 (Unauthorized) response and instructions on where to go to obtain one.
</li>
<li>If the access attempt was accompanied by an RPT, the resource server checks the RPT's status.
<ul class="text">
<li>If the RPT is invalid, the resource server responds with an HTTP 401 (Unauthorized) response and instructions on where to go to obtain a token.
</li>
<li>If the RPT is valid but has insufficient authorization data, the resource server registers a suitable requested permission on the client's behalf at the authorization server, and then responds to the client with an HTTP 403 (Forbidden) response and instructions on where to go to ask for authorization.
</li>
<li>If the RPT is valid, and if the authorization data associated with the token is sufficient for allowing access, the resource server responds with an HTTP 200 (OK) response and a representation of the resource.
</li>
</ul>
</li>
</ul>
</li>
<li>If the client (possessing no RPT or an invalid RPT) received a 401 response and an authorization server's location, after looking up its configuration data and endpoints as necessary, it requests an RPT from the RPT endpoint.
</li>
<li>If the client (posessing a valid RPT) received a 403 response and a permission ticket, it asks the authorization server for authorization data that matches the ticket. If the authorization server needs requesting party claims in order to assess this client's authorization, it engages in a claims-gathering flow with the requesting party.
<ul class="text">
<li>If the client does not already have an AAT at the appropriate authorization server to be able to use its authorization API, it first obtains one.
</li>
</ul>
</li>
</ul>

<p>The interactions are described in detail in the following sections.
</p>
<a name="r-h-attempt-access"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Client Attempts to Access Protected Resource</h3>

<p>This interaction assumes that the resource server has previously registered one or more resource sets that correspond to the resource to which access is being attempted.
</p>
<p>The client attempts to access a protected resource (for example, when an end-user requesting party clicks on a thumbnail representation of the resource to retrieve a larger version). It is expected to discover, or be provisioned or configured with, knowledge of the protected resource and its location out of band. Further, the client is expected to acquire its own knowledge about the application-specific methods made available by the resource server for operating on this protected resource (such as viewing it with a GET method, or transforming it with some complex API call) and the possible scopes of access.
</p>
<p>The access attempt either is or is not accompanied by an RPT.
</p>
<a name="no-rpt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Client Presents No RPT</h3>

<p>Example of a request carrying no RPT:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
GET /album/photo.jpg HTTP/1.1
Host: photoz.example.com
...
</pre></div>
<p>If the client does not present an RPT with the request, the resource server MUST return an HTTP 401 (Unauthorized) status code, along with providing the authorization server's URI in an "as_uri" property to facilitate authorization server configuration data discovery, including discovery of the endpoint where the client can request an RPT (<a class='info' href='#authz-permission-token'>Section&nbsp;3.4.1<span> (</span><span class='info'>Client Obtains RPT</span><span>)</span></a>).
</p>
<p>For example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 401 Unauthorized
   WWW-Authenticate: UMA realm="example",
    host_id="photoz.example.com",
    as_uri="http://as.example.com"
   ...
</pre></div>
<a name="client-presents-rpt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Client Presents RPT</h3>

<p>Example of a request carrying an RPT using the UMA "bearer" token profile:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
GET /album/photo.jpg HTTP/1.1
Authorization: Bearer vF9dft4qmT
Host: photoz.example.com
...
</pre></div>
<p>If the client presents an RPT with its request, the resource server MUST determine the RPT's status (see <a class='info' href='#h-am-rpt-status'>Section&nbsp;3.3<span> (</span><span class='info'>Resource Server Determines RPT's Status</span><span>)</span></a>) before responding.
</p>
<p>If the RPT is invalid, the resource server MUST return an HTTP 401 (Unauthorized) status code, along with providing the authorization server's URI in an "as_uri" property in the header, similarly to the case where no RPT was presented.
</p>
<p>If the RPT is valid but has insufficient authorization data for the type of access sought, the resource server SHOULD register a requested permission with the authorization server that would suffice for that scope of access (see <a class='info' href='#h-am-register-permission'>Section&nbsp;3.2<span> (</span><span class='info'>Resource Server Registers Requested Permission With Authorization Server</span><span>)</span></a>), and then respond with the HTTP 403 (Forbidden) status code, along with providing the authorization server's URI in an "as_uri" property in the header, and the permission ticket it just received from the AM in the body in a JSON-encoded "ticket" property.
</p>
<p>Example of the host's response after having registered a requested permission and received a ticket:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 403 Forbidden
WWW-Authenticate: UMA realm="example",
  host_id="photoz.example.com",
  as_uri="http://as.example.com"
  error="insufficient_scope"

{
"ticket": "016f84e8-f9b9-11e0-bd6f-0021cc6004de"
}
</pre></div>
<p>If the RPT's status is associated with authorization data that is consistent with authorized access of the scope sought by the client, the resource server MUST give access to the desired resource.
</p>
<p>Example of the resource server's response after having determineed that the RPT is valid and associated with sufficient authorization data:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 200 OK
Content-Type: image/jpeg
...

/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja
3kAAQAEAAAAPAAA/+4ADkFkb2JlAGTAAAAAAf
/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAo
KCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwb
</pre></div>
<p>The resource server MUST NOT give access where the token's status is not associated with sufficient authorization data for the attempted scope of access.
</p>
<a name="h-am-register-permission"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Resource Server Registers Requested Permission With Authorization Server</h3>

<p>In response to receiving an access request accompanied by an RPT that has insufficient authorization data, the resource server registers a permission with the authorization server that would be sufficient for the type of access sought. The authorization server returns a permission ticket for the resource server to give to the client in its response.
</p>
<p>The permission ticket is a short-lived opaque structure whose form is determined by the authorization server. The ticket value MUST be securely random (for example, not merely part of a predictable sequential series), to avoid denial-of-service attacks. Since the ticket is an opaque structure from the point of view of the client, the authorization server is free to include information regarding expiration time within the opaque ticket for its own consumption. When the client subsequently asks the authorization server for authorization data to be associated with its RPT, it will submit this ticket to the authorization server.
</p>
<p>The resource server registers the requested permission using the POST method at the authorization server's permission registration endpoint. The resource server MUST provide its valid PAT in order to get access to this endpoint. The body of the HTTP request message contains a JSON object providing the requested permission, using a format derived from the scope description format specified in <a class='info' href='#OAuth-resource-reg'>[OAuth&#8209;resource&#8209;reg]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 Resource Set Registration,&rdquo; December&nbsp;2012.</span><span>)</span></a>, as follows. The object has the following properties:</p>
<blockquote class="text"><dl>
<dt>resource_set_id</dt>
<dd>REQUIRED. The identifier for a resource set, access to which this client is seeking access. The identifier MUST correspond to a resource set that was previously registered.
</dd>
<dt>scopes</dt>
<dd>REQUIRED. An array referencing one or more identifiers of scopes to which access is needed for this resource set. Each scope identifier MUST correspond to a scope that was registered by this resource server for the referenced resource set.
</dd>
</dl></blockquote>

<p>Example of an HTTP request that registers a requested permission at the authorization server's permission registration endpoint:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
POST /host/scope_reg_uri/photoz.example.com HTTP/1.1
Content-Type: application/json
Host: as.example.com

{
  "resource_set_id": "112210f47de98100",
  "scopes": [
      "http://photoz.example.com/dev/actions/view",
      "http://photoz.example.com/dev/actions/all"
  ]
}
</pre></div>
<p>If the registration request is successful, the authorization server responds with an HTTP 201 (Created) status code and includes the Location header in its response as well as the "ticket" property in the JSON-formatted body.
</p>
<p>For example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 201 Created
Content-Type: application/json
Location: https://as.example.com/permreg/host/photoz.example.com/5454345rdsaa4543
...

{
"ticket": "016f84e8-f9b9-11e0-bd6f-0021cc6004de"
}
</pre></div>
<p>If the registration request is authenticated properly but fails due to other reasons, the authorization server responds with an HTTP 400 (Bad Request) status code and includes one of the following UMA error codes (see <a class='info' href='#uma-error-response'>Section&nbsp;4.2<span> (</span><span class='info'>UMA Error Responses</span><span>)</span></a>):</p>
<blockquote class="text"><dl>
<dt>invalid_resource_set_id</dt>
<dd>The provided resource set identifier was not found at the authorization server.
</dd>
<dt>invalid_scope</dt>
<dd>At least one of the scopes included in the request was not registered previously by this resource server.
</dd>
</dl></blockquote>

<a name="h-am-rpt-status"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Resource Server Determines RPT's Status</h3>

<p>The resource server determines a received RPT's status, including both its validity and, if valid, its associated authorization data, before giving or refusing access to the client. An RPT is associated with a set of authorization data that governs whether the client is authorized for access. The token's nature and format are dictated by its profile; the profile might allow it to be self-contained, such that the resource server is able to determine its status locally, or might require or allow the resource server to make a run-time introspection request of the authorization server that issued the token.
</p>
<p>This specification makes one type of RPT mandatory to implement: the UMA bearer token profile, as defined in <a class='info' href='#uma-bearer-token-profile'>Section&nbsp;3.3.2<span> (</span><span class='info'>UMA Bearer Token Profile</span><span>)</span></a>. Implementers MAY define and use other RPT profiles.
</p>
<a name="token-introspection"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Token Introspection</h3>

<p>Within any RPT profile, when a resource server needs to introspect a token in a non-self-contained way to determine its status, it MUST use the authorization server's OAuth introspection endpoint, defined by <a class='info' href='#OAuth-introspection'>[OAuth&#8209;introspection]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Token Introspection,&rdquo; November&nbsp;2012.</span><span>)</span></a>. Any UMA token profile MAY require, allow, or prohibit use of the token introspection endpoint. The authorization server MUST OAuth-protect this endpoint and require a PAT from the resource server for access to it. The resource server MUST use the POST method in interacting with the endpoint, not the GET method also defined by <a class='info' href='#OAuth-introspection'>[OAuth&#8209;introspection]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Token Introspection,&rdquo; November&nbsp;2012.</span><span>)</span></a>.
</p>
<a name="uma-bearer-token-profile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
UMA Bearer Token Profile</h3>

<p>This section defines the UMA "bearer" token profile. Following is a summary:</p>
<ul class="text">
<li>Identifying URI: http://docs.kantarainitiative.org/uma/profiles/uma-token-bearer-1.0
</li>
<li>Profile author and contact information: Thomas Hardjono (hardjono@mit.edu)
</li>
<li>Updates or obsoletes: None; this profile is new.
</li>
<li>Keyword in HTTP Authorization header: "Bearer".
</li>
<li>Authorization server configuration data: To indicate authorization server support, supply the keyword "bearer" in the "uma_token_profiles_supported" property value.
</li>
<li>Syntax and semantics of token data: As defined below. The token data format mainly involves time-bounded permissions.
</li>
<li>Token data association: The data associated to the on-the-wire token by reference and retrieved at run time by the resource server through profiled use of the OAuth token introspection endpoint <a class='info' href='#OAuth-introspection'>[OAuth&#8209;introspection]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Token Introspection,&rdquo; November&nbsp;2012.</span><span>)</span></a>, as defined below.
</li>
<li>Token data processing: As defined in this section and throughout <a class='info' href='#getting-authz-accessing-resource'>Section&nbsp;3<span> (</span><span class='info'>Getting Authorization and Accessing a Resource</span><span>)</span></a> of this specification.
</li>
<li>Grant type restrictions: None.
</li>
<li>Error states: As defined below.
</li>
<li>Security and privacy considerations: As defined in this section and throughout <a class='info' href='#getting-authz-accessing-resource'>Section&nbsp;3<span> (</span><span class='info'>Getting Authorization and Accessing a Resource</span><span>)</span></a> of this specification.
</li>
<li>Binding obligations: Because this RPT profile is mandatory for authorization servers to implement, binding obligations related to the use of this token profile are documented in <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</li>
</ul>

<p>On receiving an RPT of the "Bearer" type in an authorization header from a client making an access attempt, the resource server MUST introspect the token by using the authorization server's token introspection endpoint. The PAT used by the resource server to make the introspection request provides resource-owner context to the authorization server.
</p>
<p>The authorization server responds with a JSON object with the structure dictated by <a class='info' href='#OAuth-introspection'>[OAuth&#8209;introspection]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Token Introspection,&rdquo; November&nbsp;2012.</span><span>)</span></a>, with the following constraints:</p>
<ul class="text">
<li>The expires_at property is REQUIRED.
</li>
<li>The issued_at property is REQUIRED.
</li>
<li>The scope property MUST NOT appear.
</li>
</ul>

<p>In addition, if the valid property has a "true" value, then the JSON object MUST also contain an extension property with the name "permissions" that contains an array of zero or more values, each of which is an object consisting of these properties:</p>
<blockquote class="text"><dl>
<dt>resource_set_id</dt>
<dd>REQUIRED. A string that uniquely identifies the resource set, access to which has been granted to this client on behalf of this requesting party. The identifier MUST correspond to a resource set that was previously registered as protected.
</dd>
<dt>scopes</dt>
<dd>REQUIRED. An array referencing one or more URIs of scopes to which access was granted for this resource set. Each scope MUST correspond to a scope that was registered by this host for the referenced resource set.
</dd>
<dt>expires_at</dt>
<dd>REQUIRED. Integer timestamp, measured in the number of seconds since January 1 1970 UTC, indicating when this permission will expire.
</dd>
<dt>issued_at</dt>
<dd>OPTIONAL. Integer timestamp, measured in the number of seconds since January 1 1970 UTC, indicating when this permission was originally issued.
</dd>
</dl></blockquote>

<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 200 OK
   Content-Type: application/json
   Cache-Control: no-store

   {
    "valid": true,
    "expires_at": "1256953732",
    "issued_at": "1256912345",
    "permissions": [
      {
        "resource_set_id": "112210f47de98100",
        "scopes": [
          "http://photoz.example.com/dev/actions/view",
          "http://photoz.example.com/dev/actions/all"
         ],
        "expires_at" : "1256923456"
      }
    ]
   }
</pre></div>
<a name="r-am-obtain-permission"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Client Seeks Authorization for Access</h3>

<p>In order to access a protected resource successfully, a client needs to present a valid RPT with sufficient authorization data for access. To get to this stage requires a number of previously successful steps:</p>
<ol class="text">
<li>The authorization server issues client credentials to the client. It is OPTIONAL for the client credentials to be provided dynamically through <a class='info' href='#DynClientReg'>[DynClientReg]<span> (</span><span class='info'>Richer, J., &ldquo;OAuth Dynamic Client Registration Protocol,&rdquo; November&nbsp;2012.</span><span>)</span></a>); alternatively, they MAY use a static process.
</li>
<li>The client acquires an AAT. This enables it to use authorization API endpoints.
</li>
<li>The client acquires an RPT from the RPT endpoint. See <a class='info' href='#authz-permission-token'>Section&nbsp;3.4.1<span> (</span><span class='info'>Client Obtains RPT</span><span>)</span></a> for more detail.
</li>
<li>The client asks for authorization at the authorization request endpoint, providing the permission ticket it got from the resource server. The authorization server associates authorization data with the client's RPT based on the permission ticket, the resource owner's operative policies, and the results of any claims-gathering flows with the requesting party. See <a class='info' href='#r-am-authz-scope'>Section&nbsp;3.4.2<span> (</span><span class='info'>Client Asks for Authorization Data</span><span>)</span></a> for more detail.
</li>
</ol>

<a name="authz-permission-token"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Client Obtains RPT</h3>

<p>The client might need an RPT if it has never before requested an RPT for this combination of requesting party, resource server, and authorization server, or if it has lost control of a previously issued RPT and needs a refreshed one. It obtains an RPT by performing a POST on the RPT endpoint. It MUST provide its own valid AAT in the header.
</p>
<p>Example of a request message containing an AAT:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>POST /rpt HTTP/1.1
Host: as.example.com
Authorization: Bearer jwfLG53^sad$#f
...
</pre></div>
<p>The authorization server responds with an HTTP 201 (Created) status code and provides a new RPT.
</p>
<p>For example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 201 Created
Content-Type: application/json

{
  "rpt": "sbjsbhs(/SSJHBSUSSJHVhjsgvhsgvshgsv"
}
</pre></div>
<p>If the AAT provided in the header is the same as one provided for a previously issued still-valid RPT by this authorization server, the authorization server invalidates the old RPT and issues a new one.
</p>
<p>On first issuance, the RPT is associated with no authorization data and thus does not convey any authorizations for access.
</p>
<a name="r-am-authz-scope"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Client Asks for Authorization Data</h3>

<p>Once in possession of an AAT for this authorization server, an RPT that applies to this requesting party for this resource server and this authorization server, and a permission ticket, the client asks the authorization server to give it suitable authorization data for the sought-for access. It performs a POST on the authorization request endpoint, supplying its own AAT in the header and its RPT and the permission ticket in a JSON object with properties "rpt" and ticket", respectively.
</p>
<p>Example of a request message containing an AAT, an RPT, and a permission ticket:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>POST /token_status HTTP/1.1
Host: as.example.com
Authorization: Bearer jwfLG53^sad$#f
...

{
 "rpt": "sbjsbhs(/SSJHBSUSSJHVhjsgvhsgvshgsv",
 "ticket": "016f84e8-f9b9-11e0-bd6f-0021cc6004de"
}</pre></div>
<p>The authorization server uses the ticket to look up the details of the previously registered requested permission, maps the requested permission to operative resource owner policies based on the resource set identifier and scopes in it, undergoes any claims-gathering flows required (see <a class='info' href='#authz-flows'>Section&nbsp;3.5<span> (</span><span class='info'>Claims-Gathering Flows</span><span>)</span></a>), and ultimately responds to the request. The resource owner's policies at the authorization server amount to an implicit authorization grant in governing the issuance of authorization data. (The authorization server is also free to enable the resource owner to set policies that require the owner to provide a run-time authorization grant in the form of a consent interaction, mediated by the authorization server. This setting of policies and gathering of consent is outside the scope of this specification.)
</p>
<p>The authorization server MUST base the addition of authorization data to RPTs on user policies. The nature of these policies is outside the scope of UMA, but generally speaking, they can be thought of as either independent of requesting-party features (for example, time of day) or dependent on requesting-party features (for example, whether they are over 18). Such requesting-party features can potentially be collected in a claims-gathering flow. If the authorization server does not add the requested authorization data, it responds using the appropriate HTTP status code and UMA error code (see <a class='info' href='#uma-error-response'>Section&nbsp;4.2<span> (</span><span class='info'>UMA Error Responses</span><span>)</span></a>): </p>
<blockquote class="text"><dl>
<dt>invalid_requester_ticket</dt>
<dd>The provided ticket was not found at the authorization server. The authorization server SHOULD respond with the HTTP 400 (Bad Request) status code.
</dd>
<dt>expired_requester_ticket</dt>
<dd>The provided ticket has expired. The authorization server SHOULD respond with the HTTP 400 (Bad Request) status code.
</dd>
<dt>not_authorized_permission</dt>
<dd>The client is definitively not authorized for this authorization according to user policy. The authorization server SHOULD respond with the HTTP 403 (Forbidden) status code.
</dd>
<dt>need_claims</dt>
<dd>The authorization server is unable to determine whether the client is authorized for this permission without gathering claims from the requesting party. The authorization server SHOULD respond with the HTTP 403 (Forbidden) status code. The client is therefore not authorized, but has the opportunity to engage its operator -- the requesting party -- in a claims-gathering flow with the authorization server (see <a class='info' href='#authz-flows'>Section&nbsp;3.5<span> (</span><span class='info'>Claims-Gathering Flows</span><span>)</span></a>) to continue seeking authorization.
</dd>
</dl></blockquote>

<p>For example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
...

{
  "status": "error",
  "error": "expired_requester_ticket"
}
</pre></div>
<a name="authz-flows"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Claims-Gathering Flows</h3>

<p>The process for requesting and providing claims is extensible and may have a variety of dependencies on the type of requesting party (for example, natural person or legal person) and the type of client (for example, browser, native app, or autonomously running web service). This specification provides a framework for handling end-user-driven clients and an optional "openid" claim profile, based on OpenID Connect, for gathering standardized claims from such an end-user. It also allows for the definition of additional claim profiles. The authorization server MAY support any number of claim profiles, and SHOULD document the claim profiles it supports its configuration data. For the business-level and legal implications of different claim profiles, see <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</p>
<a name="trusted-claims-human-driven"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Claims-Gathering Flow for Clients Operated by End-Users</h3>

<p>A client, whether web-based or native, is operated by an end-user in one of two typical situations:</p>
<ul class="text">
<li>The requesting party is a natural person (for example, a friend of the resource owner); the requesting party may even be the resource owner herself.
</li>
<li>The requesting party is a legal person such as a corporation, and the end-user operating the client is acting as an agent of that legal person (for example, a customer support specialist representing a credit card company).
</li>
</ul>

<p>For convenience, this specification refers to the end-user as a "requesting end-user" to cover both cases, which differ only at the level of business agreements (and potentially law), rather than technology. The authorization server has a variety of options at this point for satisfying the resource owner's policy; this specification does not dictate a single answer. For example, the authorization server could require the requesting end-user to register for and/or log in to a local authorization server account, or fill in a questionnaire, or complete a purchase. It could even require several of these operations, where the order is treated as significant for evaluating resource owner policies. A variety of claim profiling can be defined to achieve these effects.
</p>
<p>An end-user-driven client MUST redirect the requesting end-user to the authorization server in order to continue the process of seeking authorization, including a URI query parameter with the name "ticket" whose value conveys the permission ticket for which the need_claims error was received; for example, "ticket=016f84e8-f9b9-11e0-bd6f-0021cc6004de".
</p>
<p>Each claim profile MUST provide the following capabilities:</p>
<blockquote class="text"><dl>
<dt>redirect URI</dt>
<dd>A means by which the client MUST supply the URI to which the authorization server MUST redirect the requesting end-user at the end of the claims-gathering process.
</dd>
<dt>callback URI</dt>
<dd>A means by which the client OPTIONALLY supplies a callback URI for the authorization server to use.
</dd>
<dt>state</dt>
<dd>A means by which the client SHOULD supply an opaque value used to maintain state between the request and the callback; this serves as a protection against XSRF attacks.
</dd>
</dl></blockquote>

<a name="trusted-claims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1.1"></a><h3>3.5.1.1.&nbsp;
OpenID Connect Claim Profile</h3>

<p>This section defines the OpenID Connect claim profile for UMA. Following is a summary:</p>
<ul class="text">
<li>Identifying URI: http://docs.kantarainitiative.org/uma/profiles/uma-claim-openid-1.0
</li>
<li>Profile author and contact information: Thomas Hardjono (hardjono@mit.edu)
</li>
<li>Updates or obsoletes: None; this profile is new.
</li>
<li>Authorization server configuration data: To indicate support, supply the keyword "openid" in the "claim_profiles_supported" property value.
</li>
<li>Syntax and semantics of claim data: As defined below. The claim data format leverages the OpenID Connect protocol and the reserved claims defined in that specification.
</li>
<li>Claims gathering method: As defined below.
</li>
<li>Error states: None additional.
</li>
<li>Security and privacy considerations: None additional.
</li>
<li>Binding obligations: Binding obligations that apply to the use of this claim profile are documented in <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</li>
</ul>

<p>If an authorization server supports the OpenID Connect claim profile, it MUST supply the "openid" value for one of its "claim_profiles_supported" values in its configuration data.
</p>
<p>To conform to this option, the authorization server MUST do the following:</p>
<ul class="text">
<li>Serve as a conforming OpenID Relying Party and Claims Client according to <a class='info' href='#OCStandard'>[OCStandard]<span> (</span><span class='info'>Sakimura, N., &ldquo;OpenID Connect Standard 1.0,&rdquo; September&nbsp;2011.</span><span>)</span></a>
</li>
<li>Be able to utilize at least all of the reserved claims defined in <a class='info' href='#OCMessages'>[OCMessages]<span> (</span><span class='info'>Sakimura, N., &ldquo;OpenID Connect Messages 1.0,&rdquo; September&nbsp;2011.</span><span>)</span></a> in evaluating policy and adding authorization data to RPTs
</li>
<li>Use the OpenID Connect "redirect_uri" and "state" request parameters as appropriate
</li>
</ul>

<p>The authorization server can then use any conforming OpenID Connect mechanisms and typical user interfaces for engaging with the UserInfo endpoints of OpenID Providers and Claims Providers, potentially allowing for the delivery of "trusted claims" (such as a verified email address or a date or birth) on which authorization policy for access may depend.
</p>
<a name="errors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Error Messages</h3>

<p>Ultimately the resource server is responsible for either granting the access the client attempted, or returning an error response to the client with a reason for the failure. <a class='info' href='#OAuth2'>[OAuth2]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> defines several error responses for a resource server to return. UMA makes use of these error responses, but requires the resource server to "outsource" the determination of some error conditions to the authorization server. This specification defines additional UMA-specific error responses that the authorization server may give to the resource server and client as they interact with it, and that the resource server may give to the client.
</p>
<a name="oauth-error-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
OAuth Error Responses</h3>

<p>When a resource server or client attempts to access one of the authorization server endpoints or a client attempts to access a protected resource at the resource server, it has to make an authenticated request by including an OAuth access token in the HTTP request as described in <a class='info' href='#OAuth2'>[OAuth2]<span> (</span><span class='info'>Hardt, D., &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; October&nbsp;2012.</span><span>)</span></a> Section 7.2.
</p>
<p>If the request failed authentication, the authorization server or the resource server responds with an OAuth error message as described throughout <a class='info' href='#protecting-a-resource'>Section&nbsp;2<span> (</span><span class='info'>Protecting a Resource</span><span>)</span></a> and <a class='info' href='#getting-authz-accessing-resource'>Section&nbsp;3<span> (</span><span class='info'>Getting Authorization and Accessing a Resource</span><span>)</span></a>.
</p>
<a name="uma-error-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
UMA Error Responses</h3>

<p>When a resource server or client attempts to access one of the authorization server endpoints or a client attempts to access a protected resource at the resource server, if the request is successfully authenticated by OAuth means, but is invalid for another reason, the authorization server or resource server responds with an UMA error response by adding the following properties to the entity body of the HTTP response: </p>
<blockquote class="text"><dl>
<dt>error</dt>
<dd>REQUIRED. A single error code. Values for this property are defined throughout this specification.
</dd>
<dt>error_description</dt>
<dd>OPTIONAL. Human-readable text providing additional information.
</dd>
<dt>error_uri</dt>
<dd>OPTIONAL. A URI identifying a human-readable web page with information about the error.
</dd>
</dl></blockquote>

<p>The following is a common error code that applies to several UMA-specified request messages: </p>
<blockquote class="text"><dl>
<dt>invalid_request</dt>
<dd>The request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, or is otherwise malformed. The authorization server MUST respond with the HTTP 400 (Bad Request) status code.
</dd>
</dl></blockquote>

<p>For example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
...

{
  "status": "error",
  "error": "invalid_request",
  "error_description": "There is already a resource with this identifier.",
  "error_uri": "http://as.example.com/errors/resource_exists"
}
</pre></div>
<a name="profiles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Specificying Additional Profiles</h3>

<p>This specification defines a protocol that has optional features. For interoperability and to serve particular deployment scenarios, including sector-specific ones such as healthcare or e-government, third parties may want to define profiles of UMA that restrict these options.
</p>
<p>Further, this specification creates extensibility points for RPT profiles and claim profiles, and third parties may likewise want to define their own. Different RPT profile could be used, for example, to change the dividing line between authorization server and resource server responsibilities in controlling access. Different claim profiles could be used to customize sector-specific or population-specific (individual vs. employee) claim types that drive the types of policies resource owners could set.
</p>
<p>It is not practical for this specification to standardize all desired profiles. However, to serve overall interoperability goals, the following sections provide guidelines for third parties that wish to specify UMA-related profiles.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Specifying Profiles of UMA</h3>

<p>It is RECOMMENDED that profiles of UMA document the following information:
</p>
<p></p>
<ol class="text">
<li>Specify a URI that uniquely identifies the profile.
</li>
<li>Identify the responsible author and provide postal or electronic contact information.
</li>
<li>Supply references to previously defined profiles that the profile updates or obsoletes.
</li>
<li>Specify relevant authorization server configuration data defined and/or utilized by the profile.
</li>
<li>Specify the set of interactions between endpoint entites involved in the profile, calling out any restrictions on ordinary UMA-conformant operations and any extension properties used in message formats.
</li>
<li>Identify the legally responsible parties involved in each interaction and any new obligations imposed, in the fashion of <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</li>
<li>Define any additional or changed error states.
</li>
<li>Supply any additional security and privacy considerations, including analysis of threats and description of countermeasures.
</li>
</ol>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Specifying RPT Profiles</h3>

<p>It is RECOMMENDED that RPT profiles document the following information:
</p>
<p></p>
<ol class="text">
<li>Specify a URI that uniquely identifies the token profile.
</li>
<li>Identify the responsible author and provide postal or electronic contact information.
</li>
<li>Supply references to previously defined token profiles that the token profile updates or obsoletes.
</li>
<li>Specify the keyword to be used in HTTP Authorization headers with tokens conforming to this profile.
</li>
<li>Specify relevant authorization server configuration data defined and/or utilized by the token profile.
</li>
<li>Specify the syntax and semantics of the data that the authorization server associates with the token.
</li>
<li>Specify how the token data is associated with, contained within, and/or retrieved by means of, the on-the-wire token string.
</li>
<li>Specify processing rules for token data.
</li>
<li>Identify any restrictions on grant types to be used with the token profile.
</li>
<li>Define any additional or changed error states.
</li>
<li>Supply any additional security and privacy considerations.
</li>
<li>Specify any obligations specific to the token profile, in the fashion of <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</li>
</ol>

<p>See <a class='info' href='#uma-bearer-token-profile'>Section&nbsp;3.3.2<span> (</span><span class='info'>UMA Bearer Token Profile</span><span>)</span></a> for an example.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Specifying Claim Profiles</h3>

<p>It is RECOMMENDED that claim profiles document the following information:</p>
<ol class="text">
<li>Specify a URI that uniquely identifies the claim profile.
</li>
<li>Identify the responsible author and provide postal or electronic contact information.
</li>
<li>Supply references to previously defined claim profiles that the claim profile updates or obsoletes.
</li>
<li>Specify relevant authorization server configuration data defined and/or utilized by the claim profile.
</li>
<li>Specify the syntax and semantics of claim data and requests for claim data.
</li>
<li>Specify how an authorization server gathers the claims.
</li>
<li>Define any additional or changed error states.
</li>
<li>Supply any additional security and privacy considerations.
</li>
<li>Specify any obligations specific to the claim profile, in the fashion of <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</li>
</ol>

<p>See <a class='info' href='#trusted-claims'>Section&nbsp;3.5.1.1<span> (</span><span class='info'>OpenID Connect Claim Profile</span><span>)</span></a> for an example.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>This specification relies mainly on OAuth security mechanisms as well as transport-level encryption for protecting the protection and authorization API endpoints. Most PATs and AATs are likely to use OAuth bearer tokens. See <a class='info' href='#OAuth-threat'>[OAuth&#8209;threat]<span> (</span><span class='info'>Lodderstedt, T., &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; October&nbsp;2012.</span><span>)</span></a> for more information.
</p>
<p>This specification defines a number of JSON-based data formats. As a subset of the JavaScript scripting language, JSON data SHOULD be consumed through a process that does not dynamically execute it as code, to avoid malicious code execution. One way to achieve this is to use a JavaScript interpreter rather than the built-in JavaScript eval() function.
</p>
<p>(More threat model and security considerations information to come.)
</p>
<p>For information about the technical, operational, and legal elements of trust establishment between UMA entities and parties, which affects security considerations, see <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Privacy Considerations</h3>

<p>The authorization server comes to be in possession of resource set information (such as names and icons) that may reveal information about the resource owner, which the authorization server's trust relationship with the resource server is assumed to accommodate. However, the client is a less-trusted party -- in fact, entirely untrustworthy until authorization data is associated with its RPT. This specification depends on <a class='info' href='#OAuth-resource-reg'>[OAuth&#8209;resource&#8209;reg]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 Resource Set Registration,&rdquo; December&nbsp;2012.</span><span>)</span></a>, which recommends obscuring resource set identifiers in order to avoid leaking personally identifiable information to clients through the scope mechanism.
</p>
<p>(More privacy considerations information to come.)
</p>
<p>For information about the technical, operational, and legal elements of trust establishment between UMA entities and parties, which affects privacy considerations, see <a class='info' href='#UMA-obligations'>[UMA&#8209;obligations]<span> (</span><span class='info'>Maler, E., &ldquo;Binding Obligations on UMA Participants,&rdquo; April&nbsp;2012.</span><span>)</span></a>.
</p>
<a name="conformance"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Conformance</h3>

<p>This section outlines conformance requirements for various entities implementing UMA endpoints.
</p>
<p>This specification has dependencies on other specifications, as referenced under the normative references listed in this specification. Its dependencies on some specifications, such as OpenID Connect (<a class='info' href='#OCStandard'>[OCStandard]<span> (</span><span class='info'>Sakimura, N., &ldquo;OpenID Connect Standard 1.0,&rdquo; September&nbsp;2011.</span><span>)</span></a> and <a class='info' href='#OCMessages'>[OCMessages]<span> (</span><span class='info'>Sakimura, N., &ldquo;OpenID Connect Messages 1.0,&rdquo; September&nbsp;2011.</span><span>)</span></a>), are optional depending on whether the feature in question is used in the implementation.
</p>
<p>The authorization server's configuration data provides a machine-readable method for it to indicate certain of the conformance options it has chosen or supports. Several of the configuration data properties allow for indicating extension features. Where this specification does not already require optional features to be documented, it is RECOMMENDED that authorization server developers and deployers document any profiled or extended features explicitly and use configuration data to indicate their usage. See <a class='info' href='#am-endpoints'>Section&nbsp;1.4<span> (</span><span class='info'>Authorization Server Configuration Data</span><span>)</span></a> for information about providing and extending the configuration data.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This document makes no request of IANA.
</p>
<a name="Acknowledgments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgments</h3>

<p>The current editor of this specification is Thomas Hardjono of MIT. The following people are co-authors:</p>
<ul class="text">
<li>Paul C. Bryan, ForgeRock US, Inc. (former editor)
</li>
<li>Domenico Catalano, Oracle Corp.
</li>
<li>George Fletcher, AOL
</li>
<li>Maciej Machulak, Newcastle University
</li>
<li>Eve Maler, XMLgrrl.com
</li>
<li>Lukasz Moren, Newcastle University
</li>
<li>Christian Scholz, COMlounge GmbH (former editor)
</li>
<li>Jacek Szpot, Newcastle University
</li>
</ul>

<p>Additional contributors to this specification include the Kantara UMA Work Group participants, a list of whom can be found at <a class='info' href='#UMAnitarians'>[UMAnitarians]<span> (</span><span class='info'>Maler, E., &ldquo;UMA Participant Roster,&rdquo; 2012.</span><span>)</span></a>.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Issues</h3>

<p>All issues are now captured at the project's GitHub site (<a href='https://github.com/xmlgrrl/UMA-Specifications/issues'>https://github.com/xmlgrrl/UMA-Specifications/issues</a>).
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DynClientReg">[DynClientReg]</a></td>
<td class="author-text">Richer, J., &ldquo;<a href="https://datatracker.ietf.org/doc/draft-ietf-oauth-dyn-reg/">OAuth Dynamic Client Registration Protocol</a>,&rdquo; November&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth-SAML">[OAuth-SAML]</a></td>
<td class="author-text">Campbell, B., &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a>,&rdquo; November&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth-bearer">[OAuth-bearer]</a></td>
<td class="author-text">&ldquo;<a href="http://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>,&rdquo; October&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth-introspection">[OAuth-introspection]</a></td>
<td class="author-text">Richer, J., &ldquo;<a href="http://tools.ietf.org/html/draft-richer-oauth-introspection">OAuth Token Introspection</a>,&rdquo; November&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth-resource-reg">[OAuth-resource-reg]</a></td>
<td class="author-text">Hardjono, T., &ldquo;<a href="https://tools.ietf.org/html/draft-hardjono-oauth-resource-reg">OAuth 2.0 Resource Set Registration</a>,&rdquo; December&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth-threat">[OAuth-threat]</a></td>
<td class="author-text">Lodderstedt, T., &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-threatmodel">OAuth 2.0 Threat Model and Security Considerations</a>,&rdquo; October&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth2">[OAuth2]</a></td>
<td class="author-text">Hardt, D., &ldquo;<a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a>,&rdquo; October&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OCMessages">[OCMessages]</a></td>
<td class="author-text">Sakimura, N., &ldquo;<a href="http://openid.net/specs/openid-connect-messages-1_0.html">OpenID Connect Messages 1.0</a>,&rdquo; September&nbsp;2011.</td></tr>
<tr><td class="author-text" valign="top"><a name="OCStandard">[OCStandard]</a></td>
<td class="author-text">Sakimura, N., &ldquo;<a href="http://openid.net/specs/openid-connect-standard-1_0.html">OpenID Connect Standard 1.0</a>,&rdquo; September&nbsp;2011.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4627">[RFC4627]</a></td>
<td class="author-text">Crockford, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>,&rdquo; RFC&nbsp;4627, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4627.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="UMA-obligations">[UMA-obligations]</a></td>
<td class="author-text">Maler, E., &ldquo;<a href="http://kantarainitiative.org/confluence/display/uma/UMA+Trust+Model">Binding Obligations on UMA Participants</a>,&rdquo; April&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="hostmeta">[hostmeta]</a></td>
<td class="author-text">Hammer-Lahav, E., &ldquo;<a href="http://tools.ietf.org/html/rfc6415">Web Host Metadata</a>,&rdquo; October&nbsp;2011.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="OAuth-linktypes">[OAuth-linktypes]</a></td>
<td class="author-text">Mills, W., &ldquo;<a href="http://tools.ietf.org/html/draft-wmills-oauth-lrdd">Link Type Registrations for OAuth 2</a>,&rdquo; October&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth-meta">[OAuth-meta]</a></td>
<td class="author-text">Sakimura, N., &ldquo;<a href="http://tools.ietf.org/html/draft-sakimura-oauth-meta">JSON Metadata for OAuth Responses</a>,&rdquo; December&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="UMA-casestudies">[UMA-casestudies]</a></td>
<td class="author-text">Maler, E., &ldquo;<a href="http://kantarainitiative.org/confluence/display/uma/Case+Studies">UMA Case Studies</a>,&rdquo; December&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="UMA-usecases">[UMA-usecases]</a></td>
<td class="author-text">Maler, E., &ldquo;<a href="http://kantarainitiative.org/confluence/display/uma/UMA+Scenarios+and+Use+Cases">UMA Scenarios and Use Cases</a>,&rdquo; October&nbsp;2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="UMAnitarians">[UMAnitarians]</a></td>
<td class="author-text">Maler, E., &ldquo;<a href="http://kantarainitiative.org/confluence/display/uma/Participant+Roster">UMA Participant Roster</a>,&rdquo; 2012.</td></tr>
</table>

<a name="History"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Document History</h3>

<p>NOTE: To be removed by RFC editor before publication as an RFC.
</p>
<p>From I-D rev 05 to rev 07, the following major changes have been made:</p>
<ul class="text">
<li>The authorization server configuration data now allows for providing a dynamic client registration endpoint (now defined by the official OAuth dynamic client registration spec), rather than just serving as a flag for whether the generic feature is support. (breaking change)
</li>
<li>The permission_request_endpoint in configuration has been renamed to authorization_request_endpoint. (breaking change)
</li>
<li>The rpt_status_endpoint in configuration data has been renamed to introspection_endpoint. (breaking change)
</li>
<li>The am_uri header in resource server 401 responses to the client has been renamed to as_uri due to terminology changes (see below). (breaking change)
</li>
<li>The OAuth error "insufficient_scope" is now a central part of the authorization server's response to a client with a valid RPT and insufficient scope. This aligns UMA more closely with OAuth as a profile thereof. (breaking change)
</li>
<li>Terminology has been changed wholesale from UMA-specific terms to OAuth-generic terms. Authorization manager (AM) is now authorization server. Host is now resource server. Authorizing user is now resource owner. Requester is now client. Some additional terms and concepts have been tweaked, enhanced and clarified. Authorization data is now defined as a generic category, of which permissions are an instance. RPT now stands for requesting party token instead of requester permission token. UMA is more explicitly defined as a profile of OAuth.
</li>
<li>The OAuth token introspection spec proposal is now used for RPT status determination. As a result, the introspection request uses form-encoded (not JSON), and the response looks different. (breaking change)
</li>
<li>The resource set registration process (phase 1) has been moved to a separate modular spec that is designed to be usable by other OAuth-based technologies along with UMA.
</li>
<li>Specific JSON-flavored content types have been removed (application/something+json).
</li>
<li>Resolved a textual inconsistency: If a client presents an invalid RPT, the resource server doesn't eagerly register a requested permission.
</li>
<li>Resolved a textual inconsistency: Removed mention of the requested_permission object name, which was not actually used.
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thomas Hardjono (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">MIT</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hardjono@mit.edu">hardjono@mit.edu</a></td></tr>
</table>
</body></html>
